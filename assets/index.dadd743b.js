(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();var E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xe={exports:{}},Ee=typeof Reflect=="object"?Reflect:null,kt=Ee&&typeof Ee.apply=="function"?Ee.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},Ye;Ee&&typeof Ee.ownKeys=="function"?Ye=Ee.ownKeys:Object.getOwnPropertySymbols?Ye=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Ye=function(t){return Object.getOwnPropertyNames(t)};function mi(i){console&&console.warn&&console.warn(i)}var pr=Number.isNaN||function(t){return t!==t};function N(){N.init.call(this)}Xe.exports=N;Xe.exports.once=_i;N.EventEmitter=N;N.prototype._events=void 0;N.prototype._eventsCount=0;N.prototype._maxListeners=void 0;var Ut=10;function Qe(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(N,"defaultMaxListeners",{enumerable:!0,get:function(){return Ut},set:function(i){if(typeof i!="number"||i<0||pr(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");Ut=i}});N.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};N.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||pr(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function yr(i){return i._maxListeners===void 0?N.defaultMaxListeners:i._maxListeners}N.prototype.getMaxListeners=function(){return yr(this)};N.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n=t==="error",o=this._events;if(o!==void 0)n=n&&o.error===void 0;else if(!n)return!1;if(n){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var d=o[t];if(d===void 0)return!1;if(typeof d=="function")kt(d,this,e);else for(var u=d.length,h=_r(d,u),r=0;r<u;++r)kt(h[r],this,e);return!0};function mr(i,t,e,r){var n,o,a;if(Qe(e),o=i._events,o===void 0?(o=i._events=Object.create(null),i._eventsCount=0):(o.newListener!==void 0&&(i.emit("newListener",t,e.listener?e.listener:e),o=i._events),a=o[t]),a===void 0)a=o[t]=e,++i._eventsCount;else if(typeof a=="function"?a=o[t]=r?[e,a]:[a,e]:r?a.unshift(e):a.push(e),n=yr(i),n>0&&a.length>n&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=i,s.type=t,s.count=a.length,mi(s)}return i}N.prototype.addListener=function(t,e){return mr(this,t,e,!1)};N.prototype.on=N.prototype.addListener;N.prototype.prependListener=function(t,e){return mr(this,t,e,!0)};function vi(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function vr(i,t,e){var r={fired:!1,wrapFn:void 0,target:i,type:t,listener:e},n=vi.bind(r);return n.listener=e,r.wrapFn=n,n}N.prototype.once=function(t,e){return Qe(e),this.on(t,vr(this,t,e)),this};N.prototype.prependOnceListener=function(t,e){return Qe(e),this.prependListener(t,vr(this,t,e)),this};N.prototype.removeListener=function(t,e){var r,n,o,a,s;if(Qe(e),n=this._events,n===void 0)return this;if(r=n[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(o=-1,a=r.length-1;a>=0;a--)if(r[a]===e||r[a].listener===e){s=r[a].listener,o=a;break}if(o<0)return this;o===0?r.shift():wi(r,o),r.length===1&&(n[t]=r[0]),n.removeListener!==void 0&&this.emit("removeListener",t,s||e)}return this};N.prototype.off=N.prototype.removeListener;N.prototype.removeAllListeners=function(t){var e,r,n;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var o=Object.keys(r),a;for(n=0;n<o.length;++n)a=o[n],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this};function wr(i,t,e){var r=i._events;if(r===void 0)return[];var n=r[t];return n===void 0?[]:typeof n=="function"?e?[n.listener||n]:[n]:e?bi(n):_r(n,n.length)}N.prototype.listeners=function(t){return wr(this,t,!0)};N.prototype.rawListeners=function(t){return wr(this,t,!1)};N.listenerCount=function(i,t){return typeof i.listenerCount=="function"?i.listenerCount(t):br.call(i,t)};N.prototype.listenerCount=br;function br(i){var t=this._events;if(t!==void 0){var e=t[i];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}N.prototype.eventNames=function(){return this._eventsCount>0?Ye(this._events):[]};function _r(i,t){for(var e=new Array(t),r=0;r<t;++r)e[r]=i[r];return e}function wi(i,t){for(;t+1<i.length;t++)i[t]=i[t+1];i.pop()}function bi(i){for(var t=new Array(i.length),e=0;e<t.length;++e)t[e]=i[e].listener||i[e];return t}function _i(i,t){return new Promise(function(e,r){function n(a){i.removeListener(t,o),r(a)}function o(){typeof i.removeListener=="function"&&i.removeListener("error",n),e([].slice.call(arguments))}Er(i,t,o,{once:!0}),t!=="error"&&Ei(i,n,{once:!0})})}function Ei(i,t,e){typeof i.on=="function"&&Er(i,"error",t,e)}function Er(i,t,e,r){if(typeof i.on=="function")r.once?i.once(t,e):i.on(t,e);else if(typeof i.addEventListener=="function")i.addEventListener(t,function n(o){r.once&&i.removeEventListener(t,n),e(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}function se(i){if(typeof i!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=i}typeof Symbol<"u"&&(se.prototype[Symbol.iterator]=function(){return this});se.of=function(){var i=arguments,t=i.length,e=0;return new se(function(){return e>=t?{done:!0}:{done:!1,value:i[e++]}})};se.empty=function(){var i=new se(function(){return{done:!0}});return i};se.fromSequence=function(i){var t=0,e=i.length;return new se(function(){return t>=e?{done:!0}:{done:!1,value:i[t++]}})};se.is=function(i){return i instanceof se?!0:typeof i=="object"&&i!==null&&typeof i.next=="function"};var X=se,mt={};mt.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";mt.SYMBOL_SUPPORT=typeof Symbol<"u";var Ai=X,Ar=mt,xi=Ar.ARRAY_BUFFER_SUPPORT,Ci=Ar.SYMBOL_SUPPORT;function Li(i){return typeof i=="string"||Array.isArray(i)||xi&&ArrayBuffer.isView(i)?Ai.fromSequence(i):typeof i!="object"||i===null?null:Ci&&typeof i[Symbol.iterator]=="function"?i[Symbol.iterator]():typeof i.next=="function"?i:null}var xr=function(t){var e=Li(t);if(!e)throw new Error("obliterator: target is not iterable nor a valid iterator.");return e},Si=xr,Cr=function(t,e){for(var r=arguments.length>1?e:1/0,n=r!==1/0?new Array(r):[],o,a=0,s=Si(t);;){if(a===r)return n;if(o=s.next(),o.done)return a!==e&&(n.length=a),n;n[a++]=o.value}},Di=X,Ii=xr,de=function(){var t=arguments,e=null,r=-1;return new Di(function(){var o=null;do{if(e===null){if(r++,r>=t.length)return{done:!0};e=Ii(t[r])}if(o=e.next(),o.done===!0){e=null;continue}break}while(!0);return o})};function Ti(){const i=arguments[0];for(let t=1,e=arguments.length;t<e;t++)if(!!arguments[t])for(const r in arguments[t])i[r]=arguments[t][r];return i}let $=Ti;typeof Object.assign=="function"&&($=Object.assign);function ie(i,t,e,r){const n=i._nodes.get(t);let o=null;return n&&(r==="mixed"?o=n.out&&n.out[e]||n.undirected&&n.undirected[e]:r==="directed"?o=n.out&&n.out[e]:o=n.undirected&&n.undirected[e]),o}function z(i){return typeof i=="object"&&i!==null&&i.constructor===Object}function Lr(i){let t;for(t in i)return!1;return!0}function te(i,t,e){Object.defineProperty(i,t,{enumerable:!1,configurable:!1,writable:!0,value:e})}function oe(i,t,e){const r={enumerable:!0,configurable:!0};typeof e=="function"?r.get=e:(r.value=e,r.writable=!1),Object.defineProperty(i,t,r)}function zt(i){return!(!z(i)||i.attributes&&!Array.isArray(i.attributes))}function Ni(){let i=Math.floor(Math.random()*256)&255;return()=>i++}class vt extends Error{constructor(t){super(),this.name="GraphError",this.message=t}}class A extends vt{constructor(t){super(t),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,A.prototype.constructor)}}class w extends vt{constructor(t){super(t),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,w.prototype.constructor)}}class S extends vt{constructor(t){super(t),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,S.prototype.constructor)}}function Sr(i,t){this.key=i,this.attributes=t,this.clear()}Sr.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Dr(i,t){this.key=i,this.attributes=t,this.clear()}Dr.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Ir(i,t){this.key=i,this.attributes=t,this.clear()}Ir.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function De(i,t,e,r,n){this.key=t,this.attributes=n,this.undirected=i,this.source=e,this.target=r}De.prototype.attach=function(){let i="out",t="in";this.undirected&&(i=t="undirected");const e=this.source.key,r=this.target.key;this.source[i][r]=this,!(this.undirected&&e===r)&&(this.target[t][e]=this)};De.prototype.attachMulti=function(){let i="out",t="in";const e=this.source.key,r=this.target.key;this.undirected&&(i=t="undirected");const n=this.source[i],o=n[r];if(typeof o>"u"){n[r]=this,this.undirected&&e===r||(this.target[t][e]=this);return}o.previous=this,this.next=o,n[r]=this,this.target[t][e]=this};De.prototype.detach=function(){const i=this.source.key,t=this.target.key;let e="out",r="in";this.undirected&&(e=r="undirected"),delete this.source[e][t],delete this.target[r][i]};De.prototype.detachMulti=function(){const i=this.source.key,t=this.target.key;let e="out",r="in";this.undirected&&(e=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[e][t],delete this.target[r][i]):(this.next.previous=void 0,this.source[e][t]=this.next,this.target[r][i]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const Tr=0,Nr=1,Pi=2,Pr=3;function ce(i,t,e,r,n,o,a){let s,d,u,h;if(r=""+r,e===Tr){if(s=i._nodes.get(r),!s)throw new w(`Graph.${t}: could not find the "${r}" node in the graph.`);u=n,h=o}else if(e===Pr){if(n=""+n,d=i._edges.get(n),!d)throw new w(`Graph.${t}: could not find the "${n}" edge in the graph.`);const c=d.source.key,l=d.target.key;if(r===c)s=d.target;else if(r===l)s=d.source;else throw new w(`Graph.${t}: the "${r}" node is not attached to the "${n}" edge (${c}, ${l}).`);u=o,h=a}else{if(d=i._edges.get(r),!d)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`);e===Nr?s=d.source:s=d.target,u=n,h=o}return[s,u,h]}function Fi(i,t,e){i.prototype[t]=function(r,n,o){const[a,s]=ce(this,t,e,r,n,o);return a.attributes[s]}}function Gi(i,t,e){i.prototype[t]=function(r,n){const[o]=ce(this,t,e,r,n);return o.attributes}}function Mi(i,t,e){i.prototype[t]=function(r,n,o){const[a,s]=ce(this,t,e,r,n,o);return a.attributes.hasOwnProperty(s)}}function Ri(i,t,e){i.prototype[t]=function(r,n,o,a){const[s,d,u]=ce(this,t,e,r,n,o,a);return s.attributes[d]=u,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:d}),this}}function Oi(i,t,e){i.prototype[t]=function(r,n,o,a){const[s,d,u]=ce(this,t,e,r,n,o,a);if(typeof u!="function")throw new A(`Graph.${t}: updater should be a function.`);const h=s.attributes,c=u(h[d]);return h[d]=c,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:d}),this}}function $i(i,t,e){i.prototype[t]=function(r,n,o){const[a,s]=ce(this,t,e,r,n,o);return delete a.attributes[s],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:s}),this}}function ki(i,t,e){i.prototype[t]=function(r,n,o){const[a,s]=ce(this,t,e,r,n,o);if(!z(s))throw new A(`Graph.${t}: provided attributes are not a plain object.`);return a.attributes=s,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function Ui(i,t,e){i.prototype[t]=function(r,n,o){const[a,s]=ce(this,t,e,r,n,o);if(!z(s))throw new A(`Graph.${t}: provided attributes are not a plain object.`);return $(a.attributes,s),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:s}),this}}function zi(i,t,e){i.prototype[t]=function(r,n,o){const[a,s]=ce(this,t,e,r,n,o);if(typeof s!="function")throw new A(`Graph.${t}: provided updater is not a function.`);return a.attributes=s(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const ji=[{name:i=>`get${i}Attribute`,attacher:Fi},{name:i=>`get${i}Attributes`,attacher:Gi},{name:i=>`has${i}Attribute`,attacher:Mi},{name:i=>`set${i}Attribute`,attacher:Ri},{name:i=>`update${i}Attribute`,attacher:Oi},{name:i=>`remove${i}Attribute`,attacher:$i},{name:i=>`replace${i}Attributes`,attacher:ki},{name:i=>`merge${i}Attributes`,attacher:Ui},{name:i=>`update${i}Attributes`,attacher:zi}];function Bi(i){ji.forEach(function({name:t,attacher:e}){e(i,t("Node"),Tr),e(i,t("Source"),Nr),e(i,t("Target"),Pi),e(i,t("Opposite"),Pr)})}function Wi(i,t,e){i.prototype[t]=function(r,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+n;if(n=arguments[2],o=ie(this,a,s,e),!o)throw new w(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return o.attributes[n]}}function Hi(i,t,e){i.prototype[t]=function(r){let n;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+arguments[1];if(n=ie(this,o,a,e),!n)throw new w(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,n=this._edges.get(r),!n)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return n.attributes}}function qi(i,t,e){i.prototype[t]=function(r,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+n;if(n=arguments[2],o=ie(this,a,s,e),!o)throw new w(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return o.attributes.hasOwnProperty(n)}}function Zi(i,t,e){i.prototype[t]=function(r,n,o){let a;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,d=""+n;if(n=arguments[2],o=arguments[3],a=ie(this,s,d,e),!a)throw new w(`Graph.${t}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return a.attributes[n]=o,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:n}),this}}function Yi(i,t,e){i.prototype[t]=function(r,n,o){let a;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,d=""+n;if(n=arguments[2],o=arguments[3],a=ie(this,s,d,e),!a)throw new w(`Graph.${t}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(typeof o!="function")throw new A(`Graph.${t}: updater should be a function.`);return a.attributes[n]=o(a.attributes[n]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:n}),this}}function Vi(i,t,e){i.prototype[t]=function(r,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+n;if(n=arguments[2],o=ie(this,a,s,e),!o)throw new w(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return delete o.attributes[n],this.emit("edgeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:n}),this}}function Ki(i,t,e){i.prototype[t]=function(r,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+n;if(n=arguments[2],o=ie(this,a,s,e),!o)throw new w(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(!z(n))throw new A(`Graph.${t}: provided attributes are not a plain object.`);return o.attributes=n,this.emit("edgeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function Xi(i,t,e){i.prototype[t]=function(r,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+n;if(n=arguments[2],o=ie(this,a,s,e),!o)throw new w(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(!z(n))throw new A(`Graph.${t}: provided attributes are not a plain object.`);return $(o.attributes,n),this.emit("edgeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:n}),this}}function Qi(i,t,e){i.prototype[t]=function(r,n){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new S(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new S(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+n;if(n=arguments[2],o=ie(this,a,s,e),!o)throw new w(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(e!=="mixed")throw new S(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new w(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(typeof n!="function")throw new A(`Graph.${t}: provided updater is not a function.`);return o.attributes=n(o.attributes),this.emit("edgeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const Ji=[{name:i=>`get${i}Attribute`,attacher:Wi},{name:i=>`get${i}Attributes`,attacher:Hi},{name:i=>`has${i}Attribute`,attacher:qi},{name:i=>`set${i}Attribute`,attacher:Zi},{name:i=>`update${i}Attribute`,attacher:Yi},{name:i=>`remove${i}Attribute`,attacher:Vi},{name:i=>`replace${i}Attributes`,attacher:Ki},{name:i=>`merge${i}Attributes`,attacher:Xi},{name:i=>`update${i}Attributes`,attacher:Qi}];function en(i){Ji.forEach(function({name:t,attacher:e}){e(i,t("Edge"),"mixed"),e(i,t("DirectedEdge"),"directed"),e(i,t("UndirectedEdge"),"undirected")})}const tn=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function rn(i,t,e,r){let n=!1;for(const o in t){if(o===r)continue;const a=t[o];if(n=e(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),i&&n)return a.key}}function nn(i,t,e,r){let n,o,a,s=!1;for(const d in t)if(d!==r){n=t[d];do{if(o=n.source,a=n.target,s=e(n.key,n.attributes,o.key,a.key,o.attributes,a.attributes,n.undirected),i&&s)return n.key;n=n.next}while(n!==void 0)}}function at(i,t){const e=Object.keys(i),r=e.length;let n,o=0;return new X(function(){do if(n)n=n.next;else{if(o>=r)return{done:!0};const s=e[o++];if(s===t){n=void 0;continue}n=i[s]}while(!n);return{done:!1,value:{edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected}}})}function on(i,t,e,r){const n=t[e];if(!n)return;const o=n.source,a=n.target;if(r(n.key,n.attributes,o.key,a.key,o.attributes,a.attributes,n.undirected)&&i)return n.key}function an(i,t,e,r){let n=t[e];if(!n)return;let o=!1;do{if(o=r(n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes,n.undirected),i&&o)return n.key;n=n.next}while(n!==void 0)}function st(i,t){let e=i[t];return e.next!==void 0?new X(function(){if(!e)return{done:!0};const r={edge:e.key,attributes:e.attributes,source:e.source.key,target:e.target.key,sourceAttributes:e.source.attributes,targetAttributes:e.target.attributes,undirected:e.undirected};return e=e.next,{done:!1,value:r}}):X.of({edge:e.key,attributes:e.attributes,source:e.source.key,target:e.target.key,sourceAttributes:e.source.attributes,targetAttributes:e.target.attributes,undirected:e.undirected})}function sn(i,t){if(i.size===0)return[];if(t==="mixed"||t===i.type)return typeof Array.from=="function"?Array.from(i._edges.keys()):Cr(i._edges.keys(),i._edges.size);const e=t==="undirected"?i.undirectedSize:i.directedSize,r=new Array(e),n=t==="undirected",o=i._edges.values();let a=0,s,d;for(;s=o.next(),s.done!==!0;)d=s.value,d.undirected===n&&(r[a++]=d.key);return r}function Fr(i,t,e,r){if(t.size===0)return;const n=e!=="mixed"&&e!==t.type,o=e==="undirected";let a,s,d=!1;const u=t._edges.values();for(;a=u.next(),a.done!==!0;){if(s=a.value,n&&s.undirected!==o)continue;const{key:h,attributes:c,source:l,target:f}=s;if(d=r(h,c,l.key,f.key,l.attributes,f.attributes,s.undirected),i&&d)return h}}function un(i,t){if(i.size===0)return X.empty();const e=t!=="mixed"&&t!==i.type,r=t==="undirected",n=i._edges.values();return new X(function(){let a,s;for(;;){if(a=n.next(),a.done)return a;if(s=a.value,!(e&&s.undirected!==r))break}return{value:{edge:s.key,attributes:s.attributes,source:s.source.key,target:s.target.key,sourceAttributes:s.source.attributes,targetAttributes:s.target.attributes,undirected:s.undirected},done:!1}})}function wt(i,t,e,r,n,o){const a=t?nn:rn;let s;if(e!=="undirected"&&(r!=="out"&&(s=a(i,n.in,o),i&&s)||r!=="in"&&(s=a(i,n.out,o,r?void 0:n.key),i&&s))||e!=="directed"&&(s=a(i,n.undirected,o),i&&s))return s}function dn(i,t,e,r){const n=[];return wt(!1,i,t,e,r,function(o){n.push(o)}),n}function hn(i,t,e){let r=X.empty();return i!=="undirected"&&(t!=="out"&&typeof e.in<"u"&&(r=de(r,at(e.in))),t!=="in"&&typeof e.out<"u"&&(r=de(r,at(e.out,t?void 0:e.key)))),i!=="directed"&&typeof e.undirected<"u"&&(r=de(r,at(e.undirected))),r}function bt(i,t,e,r,n,o,a){const s=e?an:on;let d;if(t!=="undirected"&&(typeof n.in<"u"&&r!=="out"&&(d=s(i,n.in,o,a),i&&d)||typeof n.out<"u"&&r!=="in"&&(r||n.key!==o)&&(d=s(i,n.out,o,a),i&&d))||t!=="directed"&&typeof n.undirected<"u"&&(d=s(i,n.undirected,o,a),i&&d))return d}function cn(i,t,e,r,n){const o=[];return bt(!1,i,t,e,r,n,function(a){o.push(a)}),o}function ln(i,t,e,r){let n=X.empty();return i!=="undirected"&&(typeof e.in<"u"&&t!=="out"&&r in e.in&&(n=de(n,st(e.in,r))),typeof e.out<"u"&&t!=="in"&&r in e.out&&(t||e.key!==r)&&(n=de(n,st(e.out,r)))),i!=="directed"&&typeof e.undirected<"u"&&r in e.undirected&&(n=de(n,st(e.undirected,r))),n}function fn(i,t){const{name:e,type:r,direction:n}=t;i.prototype[e]=function(o,a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return sn(this,r);if(arguments.length===1){o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new w(`Graph.${e}: could not find the "${o}" node in the graph.`);return dn(this.multi,r==="mixed"?this.type:r,n,s)}if(arguments.length===2){o=""+o,a=""+a;const s=this._nodes.get(o);if(!s)throw new w(`Graph.${e}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new w(`Graph.${e}:  could not find the "${a}" target node in the graph.`);return cn(r,this.multi,n,s,a)}throw new A(`Graph.${e}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function gn(i,t){const{name:e,type:r,direction:n}=t,o="forEach"+e[0].toUpperCase()+e.slice(1,-1);i.prototype[o]=function(u,h,c){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return c=u,Fr(!1,this,r,c);if(arguments.length===2){u=""+u,c=h;const l=this._nodes.get(u);if(typeof l>"u")throw new w(`Graph.${o}: could not find the "${u}" node in the graph.`);return wt(!1,this.multi,r==="mixed"?this.type:r,n,l,c)}if(arguments.length===3){u=""+u,h=""+h;const l=this._nodes.get(u);if(!l)throw new w(`Graph.${o}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(h))throw new w(`Graph.${o}:  could not find the "${h}" target node in the graph.`);return bt(!1,r,this.multi,n,l,h,c)}throw new A(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+e[0].toUpperCase()+e.slice(1);i.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),h=u.pop();let c;if(u.length===0){let l=0;r!=="directed"&&(l+=this.undirectedSize),r!=="undirected"&&(l+=this.directedSize),c=new Array(l);let f=0;u.push((p,m,x,y,v,C,_)=>{c[f++]=h(p,m,x,y,v,C,_)})}else c=[],u.push((l,f,p,m,x,y,v)=>{c.push(h(l,f,p,m,x,y,v))});return this[o].apply(this,u),c};const s="filter"+e[0].toUpperCase()+e.slice(1);i.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),h=u.pop(),c=[];return u.push((l,f,p,m,x,y,v)=>{h(l,f,p,m,x,y,v)&&c.push(l)}),this[o].apply(this,u),c};const d="reduce"+e[0].toUpperCase()+e.slice(1);i.prototype[d]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new A(`Graph.${d}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new A(`Graph.${d}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h,c;u.length===2?(h=u[0],c=u[1],u=[]):u.length===3?(h=u[1],c=u[2],u=[u[0]]):u.length===4&&(h=u[2],c=u[3],u=[u[0],u[1]]);let l=c;return u.push((f,p,m,x,y,v,C)=>{l=h(l,f,p,m,x,y,v,C)}),this[o].apply(this,u),l}}function pn(i,t){const{name:e,type:r,direction:n}=t,o="find"+e[0].toUpperCase()+e.slice(1,-1);i.prototype[o]=function(d,u,h){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return h=d,Fr(!0,this,r,h);if(arguments.length===2){d=""+d,h=u;const c=this._nodes.get(d);if(typeof c>"u")throw new w(`Graph.${o}: could not find the "${d}" node in the graph.`);return wt(!0,this.multi,r==="mixed"?this.type:r,n,c,h)}if(arguments.length===3){d=""+d,u=""+u;const c=this._nodes.get(d);if(!c)throw new w(`Graph.${o}:  could not find the "${d}" source node in the graph.`);if(!this._nodes.has(u))throw new w(`Graph.${o}:  could not find the "${u}" target node in the graph.`);return bt(!0,r,this.multi,n,c,u,h)}throw new A(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+e[0].toUpperCase()+e.slice(1,-1);i.prototype[a]=function(){const d=Array.prototype.slice.call(arguments),u=d.pop();return d.push((c,l,f,p,m,x,y)=>u(c,l,f,p,m,x,y)),!!this[o].apply(this,d)};const s="every"+e[0].toUpperCase()+e.slice(1,-1);i.prototype[s]=function(){const d=Array.prototype.slice.call(arguments),u=d.pop();return d.push((c,l,f,p,m,x,y)=>!u(c,l,f,p,m,x,y)),!this[o].apply(this,d)}}function yn(i,t){const{name:e,type:r,direction:n}=t,o=e.slice(0,-1)+"Entries";i.prototype[o]=function(a,s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return X.empty();if(!arguments.length)return un(this,r);if(arguments.length===1){a=""+a;const d=this._nodes.get(a);if(!d)throw new w(`Graph.${o}: could not find the "${a}" node in the graph.`);return hn(r,n,d)}if(arguments.length===2){a=""+a,s=""+s;const d=this._nodes.get(a);if(!d)throw new w(`Graph.${o}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new w(`Graph.${o}:  could not find the "${s}" target node in the graph.`);return ln(r,n,d,s)}throw new A(`Graph.${o}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function mn(i){tn.forEach(t=>{fn(i,t),gn(i,t),pn(i,t),yn(i,t)})}const vn=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Je(){this.A=null,this.B=null}Je.prototype.wrap=function(i){this.A===null?this.A=i:this.B===null&&(this.B=i)};Je.prototype.has=function(i){return this.A!==null&&i in this.A||this.B!==null&&i in this.B};function Pe(i,t,e,r,n){for(const o in r){const a=r[o],s=a.source,d=a.target,u=s===e?d:s;if(t&&t.has(u.key))continue;const h=n(u.key,u.attributes);if(i&&h)return u.key}}function _t(i,t,e,r,n){if(t!=="mixed"){if(t==="undirected")return Pe(i,null,r,r.undirected,n);if(typeof e=="string")return Pe(i,null,r,r[e],n)}const o=new Je;let a;if(t!=="undirected"){if(e!=="out"){if(a=Pe(i,null,r,r.in,n),i&&a)return a;o.wrap(r.in)}if(e!=="in"){if(a=Pe(i,o,r,r.out,n),i&&a)return a;o.wrap(r.out)}}if(t!=="directed"&&(a=Pe(i,o,r,r.undirected,n),i&&a))return a}function wn(i,t,e){if(i!=="mixed"){if(i==="undirected")return Object.keys(e.undirected);if(typeof t=="string")return Object.keys(e[t])}const r=[];return _t(!1,i,t,e,function(n){r.push(n)}),r}function Fe(i,t,e){const r=Object.keys(e),n=r.length;let o=0;return new X(function(){let s=null;do{if(o>=n)return i&&i.wrap(e),{done:!0};const d=e[r[o++]],u=d.source,h=d.target;if(s=u===t?h:u,i&&i.has(s.key)){s=null;continue}}while(s===null);return{done:!1,value:{neighbor:s.key,attributes:s.attributes}}})}function bn(i,t,e){if(i!=="mixed"){if(i==="undirected")return Fe(null,e,e.undirected);if(typeof t=="string")return Fe(null,e,e[t])}let r=X.empty();const n=new Je;return i!=="undirected"&&(t!=="out"&&(r=de(r,Fe(n,e,e.in))),t!=="in"&&(r=de(r,Fe(n,e,e.out)))),i!=="directed"&&(r=de(r,Fe(n,e,e.undirected))),r}function _n(i,t){const{name:e,type:r,direction:n}=t;i.prototype[e]=function(o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new w(`Graph.${e}: could not find the "${o}" node in the graph.`);return wn(r==="mixed"?this.type:r,n,a)}}function En(i,t){const{name:e,type:r,direction:n}=t,o="forEach"+e[0].toUpperCase()+e.slice(1,-1);i.prototype[o]=function(u,h){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;u=""+u;const c=this._nodes.get(u);if(typeof c>"u")throw new w(`Graph.${o}: could not find the "${u}" node in the graph.`);_t(!1,r==="mixed"?this.type:r,n,c,h)};const a="map"+e[0].toUpperCase()+e.slice(1);i.prototype[a]=function(u,h){const c=[];return this[o](u,(l,f)=>{c.push(h(l,f))}),c};const s="filter"+e[0].toUpperCase()+e.slice(1);i.prototype[s]=function(u,h){const c=[];return this[o](u,(l,f)=>{h(l,f)&&c.push(l)}),c};const d="reduce"+e[0].toUpperCase()+e.slice(1);i.prototype[d]=function(u,h,c){if(arguments.length<3)throw new A(`Graph.${d}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let l=c;return this[o](u,(f,p)=>{l=h(l,f,p)}),l}}function An(i,t){const{name:e,type:r,direction:n}=t,o=e[0].toUpperCase()+e.slice(1,-1),a="find"+o;i.prototype[a]=function(u,h){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;u=""+u;const c=this._nodes.get(u);if(typeof c>"u")throw new w(`Graph.${a}: could not find the "${u}" node in the graph.`);return _t(!0,r==="mixed"?this.type:r,n,c,h)};const s="some"+o;i.prototype[s]=function(u,h){return!!this[a](u,h)};const d="every"+o;i.prototype[d]=function(u,h){return!this[a](u,(l,f)=>!h(l,f))}}function xn(i,t){const{name:e,type:r,direction:n}=t,o=e.slice(0,-1)+"Entries";i.prototype[o]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return X.empty();a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new w(`Graph.${o}: could not find the "${a}" node in the graph.`);return bn(r==="mixed"?this.type:r,n,s)}}function Cn(i){vn.forEach(t=>{_n(i,t),En(i,t),An(i,t),xn(i,t)})}function je(i,t,e,r,n){const o=r._nodes.values(),a=r.type;let s,d,u,h,c,l,f;for(;s=o.next(),s.done!==!0;){let p=!1;if(d=s.value,a!=="undirected"){h=d.out;for(u in h){c=h[u];do{if(l=c.target,p=!0,f=n(d.key,l.key,d.attributes,l.attributes,c.key,c.attributes,c.undirected),i&&f)return c;c=c.next}while(c)}}if(a!=="directed"){h=d.undirected;for(u in h)if(!(t&&d.key>u)){c=h[u];do{if(l=c.target,l.key!==u&&(l=c.source),p=!0,f=n(d.key,l.key,d.attributes,l.attributes,c.key,c.attributes,c.undirected),i&&f)return c;c=c.next}while(c)}}if(e&&!p&&(f=n(d.key,null,d.attributes,null,null,null,null),i&&f))return null}}function Ln(i,t){const e={key:i};return Lr(t.attributes)||(e.attributes=$({},t.attributes)),e}function Sn(i,t,e){const r={key:t,source:e.source.key,target:e.target.key};return Lr(e.attributes)||(r.attributes=$({},e.attributes)),i==="mixed"&&e.undirected&&(r.undirected=!0),r}function Dn(i){if(!z(i))throw new A('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in i))throw new A("Graph.import: serialized node is missing its key.");if("attributes"in i&&(!z(i.attributes)||i.attributes===null))throw new A("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function In(i){if(!z(i))throw new A('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in i))throw new A("Graph.import: serialized edge is missing its source.");if(!("target"in i))throw new A("Graph.import: serialized edge is missing its target.");if("attributes"in i&&(!z(i.attributes)||i.attributes===null))throw new A("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in i&&typeof i.undirected!="boolean")throw new A("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Tn=Ni(),Nn=new Set(["directed","undirected","mixed"]),jt=new Set(["domain","_events","_eventsCount","_maxListeners"]),Pn=[{name:i=>`${i}Edge`,generateKey:!0},{name:i=>`${i}DirectedEdge`,generateKey:!0,type:"directed"},{name:i=>`${i}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:i=>`${i}EdgeWithKey`},{name:i=>`${i}DirectedEdgeWithKey`,type:"directed"},{name:i=>`${i}UndirectedEdgeWithKey`,type:"undirected"}],Fn={allowSelfLoops:!0,multi:!1,type:"mixed"};function Gn(i,t,e){if(e&&!z(e))throw new A(`Graph.addNode: invalid attributes. Expecting an object but got "${e}"`);if(t=""+t,e=e||{},i._nodes.has(t))throw new S(`Graph.addNode: the "${t}" node already exist in the graph.`);const r=new i.NodeDataClass(t,e);return i._nodes.set(t,r),i.emit("nodeAdded",{key:t,attributes:e}),r}function Bt(i,t,e){const r=new i.NodeDataClass(t,e);return i._nodes.set(t,r),i.emit("nodeAdded",{key:t,attributes:e}),r}function Gr(i,t,e,r,n,o,a,s){if(!r&&i.type==="undirected")throw new S(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&i.type==="directed")throw new S(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!z(s))throw new A(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`);if(o=""+o,a=""+a,s=s||{},!i.allowSelfLoops&&o===a)throw new S(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const d=i._nodes.get(o),u=i._nodes.get(a);if(!d)throw new w(`Graph.${t}: source node "${o}" not found.`);if(!u)throw new w(`Graph.${t}: target node "${a}" not found.`);const h={key:null,undirected:r,source:o,target:a,attributes:s};if(e)n=i._edgeKeyGenerator();else if(n=""+n,i._edges.has(n))throw new S(`Graph.${t}: the "${n}" edge already exists in the graph.`);if(!i.multi&&(r?typeof d.undirected[a]<"u":typeof d.out[a]<"u"))throw new S(`Graph.${t}: an edge linking "${o}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const c=new De(r,n,d,u,s);i._edges.set(n,c);const l=o===a;return r?(d.undirectedDegree++,u.undirectedDegree++,l&&(d.undirectedLoops++,i._undirectedSelfLoopCount++)):(d.outDegree++,u.inDegree++,l&&(d.directedLoops++,i._directedSelfLoopCount++)),i.multi?c.attachMulti():c.attach(),r?i._undirectedSize++:i._directedSize++,h.key=n,i.emit("edgeAdded",h),n}function Mn(i,t,e,r,n,o,a,s,d){if(!r&&i.type==="undirected")throw new S(`Graph.${t}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&i.type==="directed")throw new S(`Graph.${t}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(d){if(typeof s!="function")throw new A(`Graph.${t}: invalid updater function. Expecting a function but got "${s}"`)}else if(!z(s))throw new A(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`)}o=""+o,a=""+a;let u;if(d&&(u=s,s=void 0),!i.allowSelfLoops&&o===a)throw new S(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let h=i._nodes.get(o),c=i._nodes.get(a),l,f;if(!e&&(l=i._edges.get(n),l)){if((l.source.key!==o||l.target.key!==a)&&(!r||l.source.key!==a||l.target.key!==o))throw new S(`Graph.${t}: inconsistency detected when attempting to merge the "${n}" edge with "${o}" source & "${a}" target vs. ("${l.source.key}", "${l.target.key}").`);f=l}if(!f&&!i.multi&&h&&(f=r?h.undirected[a]:h.out[a]),f){const v=[f.key,!1,!1,!1];if(d?!u:!s)return v;if(d){const C=f.attributes;f.attributes=u(C),i.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})}else $(f.attributes,s),i.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:s});return v}s=s||{},d&&u&&(s=u(s));const p={key:null,undirected:r,source:o,target:a,attributes:s};if(e)n=i._edgeKeyGenerator();else if(n=""+n,i._edges.has(n))throw new S(`Graph.${t}: the "${n}" edge already exists in the graph.`);let m=!1,x=!1;h||(h=Bt(i,o,{}),m=!0,o===a&&(c=h,x=!0)),c||(c=Bt(i,a,{}),x=!0),l=new De(r,n,h,c,s),i._edges.set(n,l);const y=o===a;return r?(h.undirectedDegree++,c.undirectedDegree++,y&&(h.undirectedLoops++,i._undirectedSelfLoopCount++)):(h.outDegree++,c.inDegree++,y&&(h.directedLoops++,i._directedSelfLoopCount++)),i.multi?l.attachMulti():l.attach(),r?i._undirectedSize++:i._directedSize++,p.key=n,i.emit("edgeAdded",p),[n,!0,m,x]}function be(i,t){i._edges.delete(t.key);const{source:e,target:r,attributes:n}=t,o=t.undirected,a=e===r;o?(e.undirectedDegree--,r.undirectedDegree--,a&&(e.undirectedLoops--,i._undirectedSelfLoopCount--)):(e.outDegree--,r.inDegree--,a&&(e.directedLoops--,i._directedSelfLoopCount--)),i.multi?t.detachMulti():t.detach(),o?i._undirectedSize--:i._directedSize--,i.emit("edgeDropped",{key:t.key,attributes:n,source:e.key,target:r.key,undirected:o})}class P extends Xe.exports.EventEmitter{constructor(t){if(super(),t=$({},Fn,t),typeof t.multi!="boolean")throw new A(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${t.multi}".`);if(!Nn.has(t.type))throw new A(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${t.type}".`);if(typeof t.allowSelfLoops!="boolean")throw new A(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${t.allowSelfLoops}".`);const e=t.type==="mixed"?Sr:t.type==="directed"?Dr:Ir;te(this,"NodeDataClass",e);const r="geid_"+Tn()+"_";let n=0;const o=()=>{let a;do a=r+n++;while(this._edges.has(a));return a};te(this,"_attributes",{}),te(this,"_nodes",new Map),te(this,"_edges",new Map),te(this,"_directedSize",0),te(this,"_undirectedSize",0),te(this,"_directedSelfLoopCount",0),te(this,"_undirectedSelfLoopCount",0),te(this,"_edgeKeyGenerator",o),te(this,"_options",t),jt.forEach(a=>te(this,a,this[a])),oe(this,"order",()=>this._nodes.size),oe(this,"size",()=>this._edges.size),oe(this,"directedSize",()=>this._directedSize),oe(this,"undirectedSize",()=>this._undirectedSize),oe(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),oe(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),oe(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),oe(this,"multi",this._options.multi),oe(this,"type",this._options.type),oe(this,"allowSelfLoops",this._options.allowSelfLoops),oe(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(t){return this._nodes.has(""+t)}hasDirectedEdge(t,e){if(this.type==="undirected")return!1;if(arguments.length===1){const r=""+t,n=this._edges.get(r);return!!n&&!n.undirected}else if(arguments.length===2){t=""+t,e=""+e;const r=this._nodes.get(t);return r?r.out.hasOwnProperty(e):!1}throw new A(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(t,e){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+t,n=this._edges.get(r);return!!n&&n.undirected}else if(arguments.length===2){t=""+t,e=""+e;const r=this._nodes.get(t);return r?r.undirected.hasOwnProperty(e):!1}throw new A(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(t,e){if(arguments.length===1){const r=""+t;return this._edges.has(r)}else if(arguments.length===2){t=""+t,e=""+e;const r=this._nodes.get(t);return r?typeof r.out<"u"&&r.out.hasOwnProperty(e)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(e):!1}throw new A(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(t,e){if(this.type==="undirected")return;if(t=""+t,e=""+e,this.multi)throw new S("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const r=this._nodes.get(t);if(!r)throw new w(`Graph.directedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new w(`Graph.directedEdge: could not find the "${e}" target node in the graph.`);const n=r.out&&r.out[e]||void 0;if(n)return n.key}undirectedEdge(t,e){if(this.type==="directed")return;if(t=""+t,e=""+e,this.multi)throw new S("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(t);if(!r)throw new w(`Graph.undirectedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new w(`Graph.undirectedEdge: could not find the "${e}" target node in the graph.`);const n=r.undirected&&r.undirected[e]||void 0;if(n)return n.key}edge(t,e){if(this.multi)throw new S("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.edge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new w(`Graph.edge: could not find the "${e}" target node in the graph.`);const n=r.out&&r.out[e]||r.undirected&&r.undirected[e]||void 0;if(n)return n.key}areDirectedNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.areDirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in r.in||e in r.out}areOutNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.areOutNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in r.out}areInNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.areInNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:e in r.in}areUndirectedNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.areUndirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="directed"?!1:e in r.undirected}areNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.areNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&(e in r.in||e in r.out)||this.type!=="directed"&&e in r.undirected}areInboundNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.areInboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&e in r.in||this.type!=="directed"&&e in r.undirected}areOutboundNeighbors(t,e){t=""+t,e=""+e;const r=this._nodes.get(t);if(!r)throw new w(`Graph.areOutboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&e in r.out||this.type!=="directed"&&e in r.undirected}inDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.inDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree}outDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.outDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.outDegree}directedDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.directedDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree+e.outDegree}undirectedDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.undirectedDegree: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:e.undirectedDegree}inboundDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.inboundDegree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=e.undirectedDegree),this.type!=="undirected"&&(r+=e.inDegree),r}outboundDegree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.outboundDegree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=e.undirectedDegree),this.type!=="undirected"&&(r+=e.outDegree),r}degree(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.degree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=e.undirectedDegree),this.type!=="undirected"&&(r+=e.inDegree+e.outDegree),r}inDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.inDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree-e.directedLoops}outDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.outDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.outDegree-e.directedLoops}directedDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.directedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:e.inDegree+e.outDegree-e.directedLoops*2}undirectedDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:e.undirectedDegree-e.undirectedLoops*2}inboundDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,n=0;return this.type!=="directed"&&(r+=e.undirectedDegree,n+=e.undirectedLoops*2),this.type!=="undirected"&&(r+=e.inDegree,n+=e.directedLoops),r-n}outboundDegreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,n=0;return this.type!=="directed"&&(r+=e.undirectedDegree,n+=e.undirectedLoops*2),this.type!=="undirected"&&(r+=e.outDegree,n+=e.directedLoops),r-n}degreeWithoutSelfLoops(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.degreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,n=0;return this.type!=="directed"&&(r+=e.undirectedDegree,n+=e.undirectedLoops*2),this.type!=="undirected"&&(r+=e.inDegree+e.outDegree,n+=e.directedLoops*2),r-n}source(t){t=""+t;const e=this._edges.get(t);if(!e)throw new w(`Graph.source: could not find the "${t}" edge in the graph.`);return e.source.key}target(t){t=""+t;const e=this._edges.get(t);if(!e)throw new w(`Graph.target: could not find the "${t}" edge in the graph.`);return e.target.key}extremities(t){t=""+t;const e=this._edges.get(t);if(!e)throw new w(`Graph.extremities: could not find the "${t}" edge in the graph.`);return[e.source.key,e.target.key]}opposite(t,e){t=""+t,e=""+e;const r=this._edges.get(e);if(!r)throw new w(`Graph.opposite: could not find the "${e}" edge in the graph.`);const n=r.source.key,o=r.target.key;if(t===n)return o;if(t===o)return n;throw new w(`Graph.opposite: the "${t}" node is not attached to the "${e}" edge (${n}, ${o}).`)}hasExtremity(t,e){t=""+t,e=""+e;const r=this._edges.get(t);if(!r)throw new w(`Graph.hasExtremity: could not find the "${t}" edge in the graph.`);return r.source.key===e||r.target.key===e}isUndirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new w(`Graph.isUndirected: could not find the "${t}" edge in the graph.`);return e.undirected}isDirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new w(`Graph.isDirected: could not find the "${t}" edge in the graph.`);return!e.undirected}isSelfLoop(t){t=""+t;const e=this._edges.get(t);if(!e)throw new w(`Graph.isSelfLoop: could not find the "${t}" edge in the graph.`);return e.source===e.target}addNode(t,e){return Gn(this,t,e).key}mergeNode(t,e){if(e&&!z(e))throw new A(`Graph.mergeNode: invalid attributes. Expecting an object but got "${e}"`);t=""+t,e=e||{};let r=this._nodes.get(t);return r?(e&&($(r.attributes,e),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:r.attributes,data:e})),[t,!1]):(r=new this.NodeDataClass(t,e),this._nodes.set(t,r),this.emit("nodeAdded",{key:t,attributes:e}),[t,!0])}updateNode(t,e){if(e&&typeof e!="function")throw new A(`Graph.updateNode: invalid updater function. Expecting a function but got "${e}"`);t=""+t;let r=this._nodes.get(t);if(r){if(e){const o=r.attributes;r.attributes=e(o),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:r.attributes})}return[t,!1]}const n=e?e({}):{};return r=new this.NodeDataClass(t,n),this._nodes.set(t,r),this.emit("nodeAdded",{key:t,attributes:n}),[t,!0]}dropNode(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new w(`Graph.dropNode: could not find the "${t}" node in the graph.`);let r;if(this.type!=="undirected"){for(const n in e.out){r=e.out[n];do be(this,r),r=r.next;while(r)}for(const n in e.in){r=e.in[n];do be(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const n in e.undirected){r=e.undirected[n];do be(this,r),r=r.next;while(r)}this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:e.attributes})}dropEdge(t){let e;if(arguments.length>1){const r=""+arguments[0],n=""+arguments[1];if(e=ie(this,r,n,this.type),!e)throw new w(`Graph.dropEdge: could not find the "${r}" -> "${n}" edge in the graph.`)}else if(t=""+t,e=this._edges.get(t),!e)throw new w(`Graph.dropEdge: could not find the "${t}" edge in the graph.`);return be(this,e),this}dropDirectedEdge(t,e){if(arguments.length<2)throw new S("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new S("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");t=""+t,e=""+e;const r=ie(this,t,e,"directed");if(!r)throw new w(`Graph.dropDirectedEdge: could not find a "${t}" -> "${e}" edge in the graph.`);return be(this,r),this}dropUndirectedEdge(t,e){if(arguments.length<2)throw new S("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new S("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=ie(this,t,e,"undirected");if(!r)throw new w(`Graph.dropUndirectedEdge: could not find a "${t}" -> "${e}" edge in the graph.`);return be(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const t=this._nodes.values();let e;for(;e=t.next(),e.done!==!0;)e.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(t){return this._attributes[t]}getAttributes(){return this._attributes}hasAttribute(t){return this._attributes.hasOwnProperty(t)}setAttribute(t,e){return this._attributes[t]=e,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}updateAttribute(t,e){if(typeof e!="function")throw new A("Graph.updateAttribute: updater should be a function.");const r=this._attributes[t];return this._attributes[t]=e(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}removeAttribute(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this}replaceAttributes(t){if(!z(t))throw new A("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(t){if(!z(t))throw new A("Graph.mergeAttributes: provided attributes are not a plain object.");return $(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this}updateAttributes(t){if(typeof t!="function")throw new A("Graph.updateAttributes: provided updater is not a function.");return this._attributes=t(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(t,e){if(typeof t!="function")throw new A("Graph.updateEachNodeAttributes: expecting an updater function.");if(e&&!zt(e))throw new A("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.values();let n,o;for(;n=r.next(),n.done!==!0;)o=n.value,o.attributes=t(o.key,o.attributes);this.emit("eachNodeAttributesUpdated",{hints:e||null})}updateEachEdgeAttributes(t,e){if(typeof t!="function")throw new A("Graph.updateEachEdgeAttributes: expecting an updater function.");if(e&&!zt(e))throw new A("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let n,o,a,s;for(;n=r.next(),n.done!==!0;)o=n.value,a=o.source,s=o.target,o.attributes=t(o.key,o.attributes,a.key,s.key,a.attributes,s.attributes,o.undirected);this.emit("eachEdgeAttributesUpdated",{hints:e||null})}forEachAdjacencyEntry(t){if(typeof t!="function")throw new A("Graph.forEachAdjacencyEntry: expecting a callback.");je(!1,!1,!1,this,t)}forEachAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new A("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");je(!1,!1,!0,this,t)}forEachAssymetricAdjacencyEntry(t){if(typeof t!="function")throw new A("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");je(!1,!0,!1,this,t)}forEachAssymetricAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new A("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");je(!1,!0,!0,this,t)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):Cr(this._nodes.keys(),this._nodes.size)}forEachNode(t){if(typeof t!="function")throw new A("Graph.forEachNode: expecting a callback.");const e=this._nodes.values();let r,n;for(;r=e.next(),r.done!==!0;)n=r.value,t(n.key,n.attributes)}findNode(t){if(typeof t!="function")throw new A("Graph.findNode: expecting a callback.");const e=this._nodes.values();let r,n;for(;r=e.next(),r.done!==!0;)if(n=r.value,t(n.key,n.attributes))return n.key}mapNodes(t){if(typeof t!="function")throw new A("Graph.mapNode: expecting a callback.");const e=this._nodes.values();let r,n;const o=new Array(this.order);let a=0;for(;r=e.next(),r.done!==!0;)n=r.value,o[a++]=t(n.key,n.attributes);return o}someNode(t){if(typeof t!="function")throw new A("Graph.someNode: expecting a callback.");const e=this._nodes.values();let r,n;for(;r=e.next(),r.done!==!0;)if(n=r.value,t(n.key,n.attributes))return!0;return!1}everyNode(t){if(typeof t!="function")throw new A("Graph.everyNode: expecting a callback.");const e=this._nodes.values();let r,n;for(;r=e.next(),r.done!==!0;)if(n=r.value,!t(n.key,n.attributes))return!1;return!0}filterNodes(t){if(typeof t!="function")throw new A("Graph.filterNodes: expecting a callback.");const e=this._nodes.values();let r,n;const o=[];for(;r=e.next(),r.done!==!0;)n=r.value,t(n.key,n.attributes)&&o.push(n.key);return o}reduceNodes(t,e){if(typeof t!="function")throw new A("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new A("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let r=e;const n=this._nodes.values();let o,a;for(;o=n.next(),o.done!==!0;)a=o.value,r=t(r,a.key,a.attributes);return r}nodeEntries(){const t=this._nodes.values();return new X(()=>{const e=t.next();if(e.done)return e;const r=e.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const t=new Array(this._nodes.size);let e=0;this._nodes.forEach((n,o)=>{t[e++]=Ln(o,n)});const r=new Array(this._edges.size);return e=0,this._edges.forEach((n,o)=>{r[e++]=Sn(this.type,o,n)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:t,edges:r}}import(t,e=!1){if(t instanceof P)return t.forEachNode((d,u)=>{e?this.mergeNode(d,u):this.addNode(d,u)}),t.forEachEdge((d,u,h,c,l,f,p)=>{e?p?this.mergeUndirectedEdgeWithKey(d,h,c,u):this.mergeDirectedEdgeWithKey(d,h,c,u):p?this.addUndirectedEdgeWithKey(d,h,c,u):this.addDirectedEdgeWithKey(d,h,c,u)}),this;if(!z(t))throw new A("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!z(t.attributes))throw new A("Graph.import: invalid attributes. Expecting a plain object.");e?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}let r,n,o,a,s;if(t.nodes){if(o=t.nodes,!Array.isArray(o))throw new A("Graph.import: invalid nodes. Expecting an array.");for(r=0,n=o.length;r<n;r++){a=o[r],Dn(a);const{key:d,attributes:u}=a;e?this.mergeNode(d,u):this.addNode(d,u)}}if(t.edges){let d=!1;if(this.type==="undirected"&&(d=!0),o=t.edges,!Array.isArray(o))throw new A("Graph.import: invalid edges. Expecting an array.");for(r=0,n=o.length;r<n;r++){s=o[r],In(s);const{source:u,target:h,attributes:c,undirected:l=d}=s;let f;"key"in s?(f=e?l?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:l?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,f.call(this,s.key,u,h,c)):(f=e?l?this.mergeUndirectedEdge:this.mergeDirectedEdge:l?this.addUndirectedEdge:this.addDirectedEdge,f.call(this,u,h,c))}}return this}nullCopy(t){const e=new P($({},this._options,t));return e.replaceAttributes($({},this.getAttributes())),e}emptyCopy(t){const e=this.nullCopy(t);return this._nodes.forEach((r,n)=>{const o=$({},r.attributes);r=new e.NodeDataClass(n,o),e._nodes.set(n,r)}),e}copy(t){if(t=t||{},typeof t.type=="string"&&t.type!==this.type&&t.type!=="mixed")throw new S(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${t.type}" because this would mean losing information about the current graph.`);if(typeof t.multi=="boolean"&&t.multi!==this.multi&&t.multi!==!0)throw new S("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof t.allowSelfLoops=="boolean"&&t.allowSelfLoops!==this.allowSelfLoops&&t.allowSelfLoops!==!0)throw new S("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const e=this.emptyCopy(t),r=this._edges.values();let n,o;for(;n=r.next(),n.done!==!0;)o=n.value,Gr(e,"copy",!1,o.undirected,o.key,o.source.key,o.target.key,$({},o.attributes));return e}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const t={};this._nodes.forEach((o,a)=>{t[a]=o.attributes});const e={},r={};this._edges.forEach((o,a)=>{const s=o.undirected?"--":"->";let d="",u=o.source.key,h=o.target.key,c;o.undirected&&u>h&&(c=u,u=h,h=c);const l=`(${u})${s}(${h})`;a.startsWith("geid_")?this.multi&&(typeof r[l]>"u"?r[l]=0:r[l]++,d+=`${r[l]}. `):d+=`[${a}]: `,d+=l,e[d]=o.attributes});const n={};for(const o in this)this.hasOwnProperty(o)&&!jt.has(o)&&typeof this[o]!="function"&&typeof o!="symbol"&&(n[o]=this[o]);return n.attributes=this._attributes,n.nodes=t,n.edges=e,te(n,"constructor",this.constructor),n}}typeof Symbol<"u"&&(P.prototype[Symbol.for("nodejs.util.inspect.custom")]=P.prototype.inspect);Pn.forEach(i=>{["add","merge","update"].forEach(t=>{const e=i.name(t),r=t==="add"?Gr:Mn;i.generateKey?P.prototype[e]=function(n,o,a){return r(this,e,!0,(i.type||this.type)==="undirected",null,n,o,a,t==="update")}:P.prototype[e]=function(n,o,a,s){return r(this,e,!1,(i.type||this.type)==="undirected",n,o,a,s,t==="update")}})});Bi(P);en(P);mn(P);Cn(P);class Mr extends P{constructor(t){const e=$({type:"directed"},t);if("multi"in e&&e.multi!==!1)throw new A("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="directed")throw new A('DirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class Rr extends P{constructor(t){const e=$({type:"undirected"},t);if("multi"in e&&e.multi!==!1)throw new A("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="undirected")throw new A('UndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class Or extends P{constructor(t){const e=$({multi:!0},t);if("multi"in e&&e.multi!==!0)throw new A("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(e)}}class $r extends P{constructor(t){const e=$({type:"directed",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new A("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="directed")throw new A('MultiDirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class kr extends P{constructor(t){const e=$({type:"undirected",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new A("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="undirected")throw new A('MultiUndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}function Ie(i){i.from=function(t,e){const r=$({},t.options,e),n=new i(r);return n.import(t),n}}Ie(P);Ie(Mr);Ie(Rr);Ie(Or);Ie($r);Ie(kr);P.Graph=P;P.DirectedGraph=Mr;P.UndirectedGraph=Rr;P.MultiGraph=Or;P.MultiDirectedGraph=$r;P.MultiUndirectedGraph=kr;P.InvalidArgumentsGraphError=A;P.NotFoundGraphError=w;P.UsageGraphError=S;var ae={},Et={},Ur=function(t,e){var r=e.length;if(r!==0){var n=t.length;t.length+=r;for(var o=0;o<r;o++)t[n+o]=e[o]}},et={},zr={},D={},At=function(t){return t!==null&&typeof t=="object"&&typeof t.addUndirectedEdgeWithKey=="function"&&typeof t.dropNode=="function"&&typeof t.multi=="boolean"},W={};Object.defineProperty(W,"__esModule",{value:!0});W.multiplyVec2=W.multiply=W.translate=W.rotate=W.scale=W.identity=void 0;function Rn(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}W.identity=Rn;function On(i,t,e){return i[0]=t,i[4]=typeof e=="number"?e:t,i}W.scale=On;function $n(i,t){var e=Math.sin(t),r=Math.cos(t);return i[0]=r,i[1]=e,i[3]=-e,i[4]=r,i}W.rotate=$n;function kn(i,t,e){return i[6]=t,i[7]=e,i}W.translate=kn;function Un(i,t){var e=i[0],r=i[1],n=i[2],o=i[3],a=i[4],s=i[5],d=i[6],u=i[7],h=i[8],c=t[0],l=t[1],f=t[2],p=t[3],m=t[4],x=t[5],y=t[6],v=t[7],C=t[8];return i[0]=c*e+l*o+f*d,i[1]=c*r+l*a+f*u,i[2]=c*n+l*s+f*h,i[3]=p*e+m*o+x*d,i[4]=p*r+m*a+x*u,i[5]=p*n+m*s+x*h,i[6]=y*e+v*o+C*d,i[7]=y*r+v*a+C*u,i[8]=y*n+v*s+C*h,i}W.multiply=Un;function zn(i,t,e){e===void 0&&(e=1);var r=i[0],n=i[1],o=i[3],a=i[4],s=i[6],d=i[7],u=t.x,h=t.y;return{x:u*r+h*o+s*e,y:u*n+h*a+d*e}}W.multiplyVec2=zn;var tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.HTML_COLORS=void 0;tt.HTML_COLORS={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"};var Wt=E&&E.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),n,o=[],a;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){a={error:s}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(a)throw a.error}}return o},jn=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(D,"__esModule",{value:!0});D.validateGraph=D.canUse32BitsIndices=D.extractPixel=D.getMatrixImpact=D.matrixFromCamera=D.getCorrectionRatio=D.floatColor=D.floatArrayColor=D.parseColor=D.zIndexOrdering=D.createNormalizationFunction=D.graphExtent=D.getPixelRatio=D.createElement=D.cancelFrame=D.requestFrame=D.assignDeep=D.assign=D.isPlainObject=void 0;var Bn=jn(At),F=W,Ve=tt;function jr(i){return typeof i=="object"&&i!==null&&i.constructor===Object}D.isPlainObject=jr;function Wn(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];i=i||{};for(var r=0,n=t.length;r<n;r++){var o=t[r];!o||Object.assign(i,o)}return i}D.assign=Wn;function Br(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];i=i||{};for(var r=0,n=t.length;r<n;r++){var o=t[r];if(!!o)for(var a in o)jr(o[a])?i[a]=Br(i[a],o[a]):i[a]=o[a]}return i}D.assignDeep=Br;D.requestFrame=typeof requestAnimationFrame<"u"?function(i){return requestAnimationFrame(i)}:function(i){return setTimeout(i,0)};D.cancelFrame=typeof cancelAnimationFrame<"u"?function(i){return cancelAnimationFrame(i)}:function(i){return clearTimeout(i)};function Hn(i,t,e){var r=document.createElement(i);if(t)for(var n in t)r.style[n]=t[n];if(e)for(var n in e)r.setAttribute(n,e[n]);return r}D.createElement=Hn;function qn(){return typeof window.devicePixelRatio<"u"?window.devicePixelRatio:1}D.getPixelRatio=qn;function Zn(i){if(!i.order)return{x:[0,1],y:[0,1]};var t=1/0,e=-1/0,r=1/0,n=-1/0;return i.forEachNode(function(o,a){var s=a.x,d=a.y;s<t&&(t=s),s>e&&(e=s),d<r&&(r=d),d>n&&(n=d)}),{x:[t,e],y:[r,n]}}D.graphExtent=Zn;function Yn(i){var t=Wt(i.x,2),e=t[0],r=t[1],n=Wt(i.y,2),o=n[0],a=n[1],s=Math.max(r-e,a-o),d=(r+e)/2,u=(a+o)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(d)&&(d=0),isNaN(u)&&(u=0);var h=function(c){return{x:.5+(c.x-d)/s,y:.5+(c.y-u)/s}};return h.applyTo=function(c){c.x=.5+(c.x-d)/s,c.y=.5+(c.y-u)/s},h.inverse=function(c){return{x:d+s*(c.x-.5),y:u+s*(c.y-.5)}},h.ratio=s,h}D.createNormalizationFunction=Yn;function Vn(i,t,e){return e.sort(function(r,n){var o=t(r)||0,a=t(n)||0;return o<a?-1:o>a?1:0})}D.zIndexOrdering=Vn;var Wr=new Int8Array(4),Kn=new Int32Array(Wr.buffer,0,1),Xn=new Float32Array(Wr.buffer,0,1),Qn=/^\s*rgba?\s*\(/,Jn=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function xt(i){var t=0,e=0,r=0,n=1;if(i[0]==="#")i.length===4?(t=parseInt(i.charAt(1)+i.charAt(1),16),e=parseInt(i.charAt(2)+i.charAt(2),16),r=parseInt(i.charAt(3)+i.charAt(3),16)):(t=parseInt(i.charAt(1)+i.charAt(2),16),e=parseInt(i.charAt(3)+i.charAt(4),16),r=parseInt(i.charAt(5)+i.charAt(6),16)),i.length===9&&(n=parseInt(i.charAt(7)+i.charAt(8),16)/255);else if(Qn.test(i)){var o=i.match(Jn);o&&(t=+o[1],e=+o[2],r=+o[3],o[4]&&(n=+o[4]))}return{r:t,g:e,b:r,a:n}}D.parseColor=xt;var Ae={};for(var Be in Ve.HTML_COLORS)Ae[Be]=Hr(Ve.HTML_COLORS[Be]),Ae[Ve.HTML_COLORS[Be]]=Ae[Be];function eo(i){i=Ve.HTML_COLORS[i]||i;var t=xt(i),e=t.r,r=t.g,n=t.b,o=t.a;return new Float32Array([e/255,r/255,n/255,o])}D.floatArrayColor=eo;function Hr(i){if(typeof Ae[i]<"u")return Ae[i];var t=xt(i),e=t.r,r=t.g,n=t.b,o=t.a;o=o*255|0,Kn[0]=(o<<24|n<<16|r<<8|e)&4278190079;var a=Xn[0];return Ae[i]=a,a}D.floatColor=Hr;function qr(i,t){var e=i.height/i.width,r=t.height/t.width;return e<1&&r>1||e>1&&r<1?1:Math.min(Math.max(r,1/r),Math.max(1/e,e))}D.getCorrectionRatio=qr;function to(i,t,e,r,n){var o=i.angle,a=i.ratio,s=i.x,d=i.y,u=t.width,h=t.height,c=(0,F.identity)(),l=Math.min(u,h)-2*r,f=qr(t,e);return n?((0,F.multiply)(c,(0,F.translate)((0,F.identity)(),s,d)),(0,F.multiply)(c,(0,F.scale)((0,F.identity)(),a)),(0,F.multiply)(c,(0,F.rotate)((0,F.identity)(),o)),(0,F.multiply)(c,(0,F.scale)((0,F.identity)(),u/l/2/f,h/l/2/f))):((0,F.multiply)(c,(0,F.scale)((0,F.identity)(),2*(l/u)*f,2*(l/h)*f)),(0,F.multiply)(c,(0,F.rotate)((0,F.identity)(),-o)),(0,F.multiply)(c,(0,F.scale)((0,F.identity)(),1/a)),(0,F.multiply)(c,(0,F.translate)((0,F.identity)(),-s,-d))),c}D.matrixFromCamera=to;function ro(i,t,e){var r=(0,F.multiplyVec2)(i,{x:Math.cos(t.angle),y:Math.sin(t.angle)},0),n=r.x,o=r.y;return 1/Math.sqrt(Math.pow(n,2)+Math.pow(o,2))/e.width}D.getMatrixImpact=ro;function io(i,t,e,r){var n=r||new Uint8Array(4);return i.readPixels(t,e,1,1,i.RGBA,i.UNSIGNED_BYTE,n),n}D.extractPixel=io;function no(i){var t=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext;return t||!!i.getExtension("OES_element_index_uint")}D.canUse32BitsIndices=no;function oo(i){if(!(0,Bn.default)(i))throw new Error("Sigma: invalid graph instance.");i.forEachNode(function(t,e){if(!Number.isFinite(e.x)||!Number.isFinite(e.y))throw new Error("Sigma: Coordinates of node ".concat(t," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}D.validateGraph=oo;var Ct={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.cubicInOut=i.cubicOut=i.cubicIn=i.quadraticInOut=i.quadraticOut=i.quadraticIn=i.linear=void 0;var t=function(u){return u};i.linear=t;var e=function(u){return u*u};i.quadraticIn=e;var r=function(u){return u*(2-u)};i.quadraticOut=r;var n=function(u){return(u*=2)<1?.5*u*u:-.5*(--u*(u-2)-1)};i.quadraticInOut=n;var o=function(u){return u*u*u};i.cubicIn=o;var a=function(u){return--u*u*u+1};i.cubicOut=a;var s=function(u){return(u*=2)<1?.5*u*u*u:.5*((u-=2)*u*u+2)};i.cubicInOut=s;var d={linear:i.linear,quadraticIn:i.quadraticIn,quadraticOut:i.quadraticOut,quadraticInOut:i.quadraticInOut,cubicIn:i.cubicIn,cubicOut:i.cubicOut,cubicInOut:i.cubicInOut};i.default=d})(Ct);(function(i){var t=E&&E.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(i,"__esModule",{value:!0}),i.animateNodes=i.ANIMATE_DEFAULTS=void 0;var e=D,r=t(Ct);i.ANIMATE_DEFAULTS={easing:"quadraticInOut",duration:150};function n(o,a,s,d){var u=Object.assign({},i.ANIMATE_DEFAULTS,s),h=typeof u.easing=="function"?u.easing:r.default[u.easing],c=Date.now(),l={};for(var f in a){var p=a[f];l[f]={};for(var m in p)l[f][m]=o.getNodeAttribute(f,m)}var x=null,y=function(){x=null;var v=(Date.now()-c)/u.duration;if(v>=1){for(var C in a){var _=a[C];for(var g in _)o.setNodeAttribute(C,g,_[g])}typeof d=="function"&&d();return}v=h(v);for(var C in a){var _=a[C],b=l[C];for(var g in _)o.setNodeAttribute(C,g,_[g]*v+b[g]*(1-v))}x=(0,e.requestFrame)(y)};return y(),function(){x&&(0,e.cancelFrame)(x)}}i.animateNodes=n})(zr);var Te={},ao=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Te,"__esModule",{value:!0});Te.TypedEventEmitter=void 0;var so=Xe.exports,uo=function(i){ao(t,i);function t(){var e=i.call(this)||this;return e.rawEmitter=e,e}return t}(so.EventEmitter);Te.TypedEventEmitter=uo;var ho=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),co=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(et,"__esModule",{value:!0});var lo=zr,fo=co(Ct),ut=D,go=Te,We=1.5,po=function(i){ho(t,i);function t(){var e=i.call(this)||this;return e.x=.5,e.y=.5,e.angle=0,e.ratio=1,e.minRatio=null,e.maxRatio=null,e.nextFrame=null,e.previousState=null,e.enabled=!0,e.previousState=e.getState(),e}return t.from=function(e){var r=new t;return r.setState(e)},t.prototype.enable=function(){return this.enabled=!0,this},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.getState=function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}},t.prototype.hasState=function(e){return this.x===e.x&&this.y===e.y&&this.ratio===e.ratio&&this.angle===e.angle},t.prototype.getPreviousState=function(){var e=this.previousState;return e?{x:e.x,y:e.y,angle:e.angle,ratio:e.ratio}:null},t.prototype.getBoundedRatio=function(e){var r=e;return typeof this.minRatio=="number"&&(r=Math.max(r,this.minRatio)),typeof this.maxRatio=="number"&&(r=Math.min(r,this.maxRatio)),r},t.prototype.validateState=function(e){var r={};return typeof e.x=="number"&&(r.x=e.x),typeof e.y=="number"&&(r.y=e.y),typeof e.angle=="number"&&(r.angle=e.angle),typeof e.ratio=="number"&&(r.ratio=this.getBoundedRatio(e.ratio)),r},t.prototype.isAnimated=function(){return!!this.nextFrame},t.prototype.setState=function(e){if(!this.enabled)return this;this.previousState=this.getState();var r=this.validateState(e);return typeof r.x=="number"&&(this.x=r.x),typeof r.y=="number"&&(this.y=r.y),typeof r.angle=="number"&&(this.angle=r.angle),typeof r.ratio=="number"&&(this.ratio=r.ratio),this.hasState(this.previousState)||this.emit("updated",this.getState()),this},t.prototype.updateState=function(e){return this.setState(e(this.getState())),this},t.prototype.animate=function(e,r,n){var o=this;if(!!this.enabled){var a=Object.assign({},lo.ANIMATE_DEFAULTS,r),s=this.validateState(e),d=typeof a.easing=="function"?a.easing:fo.default[a.easing],u=Date.now(),h=this.getState(),c=function(){var l=(Date.now()-u)/a.duration;if(l>=1){o.nextFrame=null,o.setState(s),o.animationCallback&&(o.animationCallback.call(null),o.animationCallback=void 0);return}var f=d(l),p={};typeof s.x=="number"&&(p.x=h.x+(s.x-h.x)*f),typeof s.y=="number"&&(p.y=h.y+(s.y-h.y)*f),typeof s.angle=="number"&&(p.angle=h.angle+(s.angle-h.angle)*f),typeof s.ratio=="number"&&(p.ratio=h.ratio+(s.ratio-h.ratio)*f),o.setState(p),o.nextFrame=(0,ut.requestFrame)(c)};this.nextFrame?((0,ut.cancelFrame)(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=(0,ut.requestFrame)(c)):c(),this.animationCallback=n}},t.prototype.animatedZoom=function(e){if(!e)this.animate({ratio:this.ratio/We});else{if(typeof e=="number")return this.animate({ratio:this.ratio/e});this.animate({ratio:this.ratio/(e.factor||We)},e)}},t.prototype.animatedUnzoom=function(e){if(!e)this.animate({ratio:this.ratio*We});else{if(typeof e=="number")return this.animate({ratio:this.ratio*e});this.animate({ratio:this.ratio*(e.factor||We)},e)}},t.prototype.animatedReset=function(e){this.animate({x:.5,y:.5,ratio:1,angle:0},e)},t.prototype.copy=function(){return t.from(this.getState())},t}(go.TypedEventEmitter);et.default=po;var rt={},B={},yo=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),xe=E&&E.__assign||function(){return xe=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},xe.apply(this,arguments)};Object.defineProperty(B,"__esModule",{value:!0});B.getWheelDelta=B.getTouchCoords=B.getTouchesArray=B.getWheelCoords=B.getMouseCoords=B.getPosition=void 0;var mo=Te;function Lt(i,t){var e=t.getBoundingClientRect();return{x:i.clientX-e.left,y:i.clientY-e.top}}B.getPosition=Lt;function Zr(i,t){var e=xe(xe({},Lt(i,t)),{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){e.sigmaDefaultPrevented=!0},original:i});return e}B.getMouseCoords=Zr;function vo(i,t){return xe(xe({},Zr(i,t)),{delta:Vr(i)})}B.getWheelCoords=vo;var wo=2;function Yr(i){for(var t=[],e=0,r=Math.min(i.length,wo);e<r;e++)t.push(i[e]);return t}B.getTouchesArray=Yr;function bo(i,t){return{touches:Yr(i.touches).map(function(e){return Lt(e,t)}),original:i}}B.getTouchCoords=bo;function Vr(i){if(typeof i.deltaY<"u")return i.deltaY*-3/360;if(typeof i.detail<"u")return i.detail/-9;throw new Error("Captor: could not extract delta from event.")}B.getWheelDelta=Vr;var _o=function(i){yo(t,i);function t(e,r){var n=i.call(this)||this;return n.container=e,n.renderer=r,n}return t}(mo.TypedEventEmitter);B.default=_o;var Eo=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ao=E&&E.__createBinding||(Object.create?function(i,t,e,r){r===void 0&&(r=e),Object.defineProperty(i,r,{enumerable:!0,get:function(){return t[e]}})}:function(i,t,e,r){r===void 0&&(r=e),i[r]=t[e]}),xo=E&&E.__setModuleDefault||(Object.create?function(i,t){Object.defineProperty(i,"default",{enumerable:!0,value:t})}:function(i,t){i.default=t}),Co=E&&E.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)e!=="default"&&Object.prototype.hasOwnProperty.call(i,e)&&Ao(t,i,e);return xo(t,i),t};Object.defineProperty(rt,"__esModule",{value:!0});var V=Co(B),Lo=100,So=3,Do=200,Ht=3,qt=250,Zt=1.7,Io=300,To=2.2,No=200,Po=function(i){Eo(t,i);function t(e,r){var n=i.call(this,e,r)||this;return n.enabled=!0,n.draggedEvents=0,n.downStartTime=null,n.lastMouseX=null,n.lastMouseY=null,n.isMouseDown=!1,n.isMoving=!1,n.movingTimeout=null,n.startCameraState=null,n.clicks=0,n.doubleClickTimeout=null,n.currentWheelDirection=0,n.handleClick=n.handleClick.bind(n),n.handleRightClick=n.handleRightClick.bind(n),n.handleDown=n.handleDown.bind(n),n.handleUp=n.handleUp.bind(n),n.handleMove=n.handleMove.bind(n),n.handleWheel=n.handleWheel.bind(n),n.handleOut=n.handleOut.bind(n),e.addEventListener("click",n.handleClick,!1),e.addEventListener("contextmenu",n.handleRightClick,!1),e.addEventListener("mousedown",n.handleDown,!1),e.addEventListener("wheel",n.handleWheel,!1),e.addEventListener("mouseout",n.handleOut,!1),document.addEventListener("mousemove",n.handleMove,!1),document.addEventListener("mouseup",n.handleUp,!1),n}return t.prototype.kill=function(){var e=this.container;e.removeEventListener("click",this.handleClick),e.removeEventListener("contextmenu",this.handleRightClick),e.removeEventListener("mousedown",this.handleDown),e.removeEventListener("wheel",this.handleWheel),e.removeEventListener("mouseout",this.handleOut),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)},t.prototype.handleClick=function(e){var r=this;if(!!this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(e);setTimeout(function(){r.clicks=0,r.doubleClickTimeout=null},Io),this.draggedEvents<So&&this.emit("click",(0,V.getMouseCoords)(e,this.container))}},t.prototype.handleRightClick=function(e){!this.enabled||this.emit("rightClick",(0,V.getMouseCoords)(e,this.container))},t.prototype.handleDoubleClick=function(e){if(!!this.enabled){e.preventDefault(),e.stopPropagation();var r=(0,V.getMouseCoords)(e,this.container);if(this.emit("doubleClick",r),!r.sigmaDefaultPrevented){var n=this.renderer.getCamera(),o=n.getBoundedRatio(n.getState().ratio/To);n.animate(this.renderer.getViewportZoomedState((0,V.getPosition)(e,this.container),o),{easing:"quadraticInOut",duration:No})}}},t.prototype.handleDown=function(e){if(!!this.enabled){if(e.button===0){this.startCameraState=this.renderer.getCamera().getState();var r=(0,V.getPosition)(e,this.container),n=r.x,o=r.y;this.lastMouseX=n,this.lastMouseY=o,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",(0,V.getMouseCoords)(e,this.container))}},t.prototype.handleUp=function(e){var r=this;if(!(!this.enabled||!this.isMouseDown)){var n=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var o=(0,V.getPosition)(e,this.container),a=o.x,s=o.y,d=n.getState(),u=n.getPreviousState()||{x:0,y:0};this.isMoving?n.animate({x:d.x+Ht*(d.x-u.x),y:d.y+Ht*(d.y-u.y)},{duration:Do,easing:"quadraticOut"}):(this.lastMouseX!==a||this.lastMouseY!==s)&&n.setState({x:d.x,y:d.y}),this.isMoving=!1,setTimeout(function(){r.draggedEvents=0,r.renderer.refresh()},0),this.emit("mouseup",(0,V.getMouseCoords)(e,this.container))}},t.prototype.handleMove=function(e){var r=this;if(!!this.enabled){var n=(0,V.getMouseCoords)(e,this.container);if(this.emit("mousemovebody",n),e.target===this.container&&this.emit("mousemove",n),!n.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){r.movingTimeout=null,r.isMoving=!1},Lo);var o=this.renderer.getCamera(),a=(0,V.getPosition)(e,this.container),s=a.x,d=a.y,u=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),h=this.renderer.viewportToFramedGraph({x:s,y:d}),c=u.x-h.x,l=u.y-h.y,f=o.getState(),p=f.x+c,m=f.y+l;o.setState({x:p,y:m}),this.lastMouseX=s,this.lastMouseY=d,e.preventDefault(),e.stopPropagation()}}},t.prototype.handleWheel=function(e){var r=this;if(!!this.enabled){e.preventDefault(),e.stopPropagation();var n=(0,V.getWheelDelta)(e);if(!!n){var o=(0,V.getWheelCoords)(e,this.container);if(this.emit("wheel",o),!o.sigmaDefaultPrevented){var a=n>0?1/Zt:Zt,s=this.renderer.getCamera(),d=s.getBoundedRatio(s.getState().ratio*a),u=n>0?1:-1,h=Date.now();this.currentWheelDirection===u&&this.lastWheelTriggerTime&&h-this.lastWheelTriggerTime<qt/5||(s.animate(this.renderer.getViewportZoomedState((0,V.getPosition)(e,this.container),d),{easing:"quadraticOut",duration:qt},function(){r.currentWheelDirection=0}),this.currentWheelDirection=u,this.lastWheelTriggerTime=h)}}}},t.prototype.handleOut=function(){},t}(V.default);rt.default=Po;var re={},Fo=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(re,"__esModule",{value:!0});re.rectangleCollidesWithQuad=re.squareCollidesWithQuad=re.getCircumscribedAlignedRectangle=re.isRectangleAligned=void 0;var lt=Fo(Ur),K=4,Ge=5,_e=5460,H=0,q=1,Z=2,Y=3,Go=1,Mo=2,Ro=3,Oo=4,Yt=!1;function Kr(i){return i.x1===i.x2||i.y1===i.y2}re.isRectangleAligned=Kr;function Xr(i){var t=Math.sqrt(Math.pow(i.x2-i.x1,2)+Math.pow(i.y2-i.y1,2)),e={x:(i.y1-i.y2)*i.height/t,y:(i.x2-i.x1)*i.height/t},r={x:i.x1,y:i.y1},n={x:i.x2,y:i.y2},o={x:i.x1+e.x,y:i.y1+e.y},a={x:i.x2+e.x,y:i.y2+e.y},s=Math.min(r.x,n.x,o.x,a.x),d=Math.max(r.x,n.x,o.x,a.x),u=Math.min(r.y,n.y,o.y,a.y),h=Math.max(r.y,n.y,o.y,a.y);return{x1:s,y1:u,x2:d,y2:u,height:h-u}}re.getCircumscribedAlignedRectangle=Xr;function Re(i,t,e,r,n,o,a){return i<r+o&&i+e>r&&t<n+a&&t+e>n}re.squareCollidesWithQuad=Re;function Oe(i,t,e,r,n,o,a,s){return i<n+a&&i+e>n&&t<o+s&&t+r>o}re.rectangleCollidesWithQuad=Oe;function $o(i,t,e,r,n,o){var a=e+n/2,s=r+o/2,d=t<s,u=i<a;return d?u?Go:Mo:u?Ro:Oo}function ko(i,t){for(var e=[0,0];e.length;){var r=e.pop(),n=e.pop(),o=4*n+K,a=4*n+2*K,s=4*n+3*K,d=4*n+4*K,u=t[n+H],h=t[n+q],c=t[n+Z],l=t[n+Y],f=c/2,p=l/2;t[o+H]=u,t[o+q]=h,t[o+Z]=f,t[o+Y]=p,t[a+H]=u+f,t[a+q]=h,t[a+Z]=f,t[a+Y]=p,t[s+H]=u,t[s+q]=h+p,t[s+Z]=f,t[s+Y]=p,t[d+H]=u+f,t[d+q]=h+p,t[d+Z]=f,t[d+Y]=p,r<i-1&&(e.push(d,r+1),e.push(s,r+1),e.push(a,r+1),e.push(o,r+1))}}function Uo(i,t,e,r,n,o,a){for(var s=n-a,d=o-a,u=a*2,h=0,c=0;;){if(h>=i){e[c]=e[c]||[],e[c].push(r);return}var l=4*c+K,f=4*c+2*K,p=4*c+3*K,m=4*c+4*K,x=Re(s,d,u,t[l+H],t[l+q],t[l+Z],t[l+Y]),y=Re(s,d,u,t[f+H],t[f+q],t[f+Z],t[f+Y]),v=Re(s,d,u,t[p+H],t[p+q],t[p+Z],t[p+Y]),C=Re(s,d,u,t[m+H],t[m+q],t[m+Z],t[m+Y]),_=[x,y,v,C].reduce(function(g,b){return b?g+1:g},0);if(_===0&&h===0){e[_e].push(r),!Yt&&e[_e].length>=5&&(Yt=!0,console.warn("sigma/quadtree.insertNode: At least 5 nodes are outside the global quadtree zone. You might have a problem with the normalization function or the custom bounding box."));return}if(_===0)throw new Error("sigma/quadtree.insertNode: no collision (level: ".concat(h,", key: ").concat(r,", x: ").concat(n,", y: ").concat(o,", size: ").concat(a,")."));if(_===3)throw new Error("sigma/quadtree.insertNode: 3 impossible collisions (level: ".concat(h,", key: ").concat(r,", x: ").concat(n,", y: ").concat(o,", size: ").concat(a,")."));if(_>1){e[c]=e[c]||[],e[c].push(r);return}else h++;x&&(c=l),y&&(c=f),v&&(c=p),C&&(c=m)}}function zo(i,t,e,r,n,o,a){for(var s=[0,0],d=[],u;s.length;){var h=s.pop(),c=s.pop();if(u=e[c],u&&(0,lt.default)(d,u),!(h>=i)){var l=4*c+K,f=4*c+2*K,p=4*c+3*K,m=4*c+4*K,x=Oe(r,n,o,a,t[l+H],t[l+q],t[l+Z],t[l+Y]),y=Oe(r,n,o,a,t[f+H],t[f+q],t[f+Z],t[f+Y]),v=Oe(r,n,o,a,t[p+H],t[p+q],t[p+Z],t[p+Y]),C=Oe(r,n,o,a,t[m+H],t[m+q],t[m+Z],t[m+Y]);x&&s.push(l,h+1),y&&s.push(f,h+1),v&&s.push(p,h+1),C&&s.push(m,h+1)}}return d}var jo=function(){function i(t){var e;t===void 0&&(t={}),this.containers=(e={},e[_e]=[],e),this.cache=null,this.lastRectangle=null;var r=Math.pow(4,Ge);this.data=new Float32Array(K*((4*r-1)/3)),t.boundaries?this.resize(t.boundaries):this.resize({x:0,y:0,width:1,height:1})}return i.prototype.add=function(t,e,r,n){return Uo(Ge,this.data,this.containers,t,e,r,n),this},i.prototype.resize=function(t){this.clear(),this.data[H]=t.x,this.data[q]=t.y,this.data[Z]=t.width,this.data[Y]=t.height,ko(Ge,this.data)},i.prototype.clear=function(){var t;return this.containers=(t={},t[_e]=[],t),this},i.prototype.point=function(t,e){var r=this.containers[_e].slice(),n=0,o=0;do{this.containers[n]&&(0,lt.default)(r,this.containers[n]);var a=$o(t,e,this.data[n+H],this.data[n+q],this.data[n+Z],this.data[n+Y]);n=4*n+a*K,o++}while(o<=Ge);return r},i.prototype.rectangle=function(t,e,r,n,o){var a=this.lastRectangle;return a&&t===a.x1&&r===a.x2&&e===a.y1&&n===a.y2&&o===a.height?this.cache:(this.lastRectangle={x1:t,y1:e,x2:r,y2:n,height:o},Kr(this.lastRectangle)||(this.lastRectangle=Xr(this.lastRectangle)),this.cache=zo(Ge,this.data,this.containers,t,e,Math.abs(t-r)||Math.abs(e-n),o),(0,lt.default)(this.cache,this.containers[_e]),this.cache)},i}();re.default=jo;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.edgeLabelsToDisplayFromNodes=Ce.LabelGrid=void 0;var Vt=function(){function i(t,e){this.key=t,this.size=e}return i.compare=function(t,e){return t.size>e.size?-1:t.size<e.size||t.key>e.key?1:-1},i}(),Bo=function(){function i(){this.width=0,this.height=0,this.cellSize=0,this.columns=0,this.rows=0,this.cells={}}return i.prototype.resizeAndClear=function(t,e){this.width=t.width,this.height=t.height,this.cellSize=e,this.columns=Math.ceil(t.width/e),this.rows=Math.ceil(t.height/e),this.cells={}},i.prototype.getIndex=function(t){var e=Math.floor(t.x/this.cellSize),r=Math.floor(t.y/this.cellSize);return r*this.columns+e},i.prototype.add=function(t,e,r){var n=new Vt(t,e),o=this.getIndex(r),a=this.cells[o];a||(a=[],this.cells[o]=a),a.push(n)},i.prototype.organize=function(){for(var t in this.cells){var e=this.cells[t];e.sort(Vt.compare)}},i.prototype.getLabelsToDisplay=function(t,e){var r=this.cellSize*this.cellSize,n=r/t/t,o=n*e/r,a=Math.ceil(o),s=[];for(var d in this.cells)for(var u=this.cells[d],h=0;h<Math.min(a,u.length);h++)s.push(u[h].key);return s},i}();Ce.LabelGrid=Bo;function Wo(i){var t=i.graph,e=i.hoveredNode,r=i.highlightedNodes,n=i.displayedNodeLabels,o=[];return t.forEachEdge(function(a,s,d,u){(d===e||u===e||r.has(d)||r.has(u)||n.has(d)&&n.has(u))&&o.push(a)}),o}Ce.edgeLabelsToDisplayFromNodes=Wo;var Qr={},it={};Object.defineProperty(it,"__esModule",{value:!0});function Ho(i,t,e){if(!!t.label){var r=e.labelSize,n=e.labelFont,o=e.labelWeight,a=e.labelColor.attribute?t[e.labelColor.attribute]||e.labelColor.color||"#000":e.labelColor.color;i.fillStyle=a,i.font="".concat(o," ").concat(r,"px ").concat(n),i.fillText(t.label,t.x+t.size+3,t.y+r/3)}}it.default=Ho;var St={},qo=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(St,"__esModule",{value:!0});var Zo=qo(it);function Yo(i,t,e){var r=e.labelSize,n=e.labelFont,o=e.labelWeight;i.font="".concat(o," ").concat(r,"px ").concat(n),i.fillStyle="#FFF",i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=8,i.shadowColor="#000";var a=2;if(typeof t.label=="string"){var s=i.measureText(t.label).width,d=Math.round(s+5),u=Math.round(r+2*a),h=Math.max(t.size,r/2)+a,c=Math.asin(u/2/h),l=Math.sqrt(Math.abs(Math.pow(h,2)-Math.pow(u/2,2)));i.beginPath(),i.moveTo(t.x+l,t.y+u/2),i.lineTo(t.x+h+d,t.y+u/2),i.lineTo(t.x+h+d,t.y-u/2),i.lineTo(t.x+l,t.y-u/2),i.arc(t.x,t.y,h,c,-c),i.closePath(),i.fill()}else i.beginPath(),i.arc(t.x,t.y,t.size+a,0,Math.PI*2),i.closePath(),i.fill();i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,(0,Zo.default)(i,t,e)}St.default=Yo;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});function Vo(i,t,e,r,n){var o=n.edgeLabelSize,a=n.edgeLabelFont,s=n.edgeLabelWeight,d=n.edgeLabelColor.attribute?t[n.edgeLabelColor.attribute]||n.edgeLabelColor.color||"#000":n.edgeLabelColor.color,u=t.label;if(!!u){i.fillStyle=d,i.font="".concat(s," ").concat(o,"px ").concat(a);var h=e.size,c=r.size,l=e.x,f=e.y,p=r.x,m=r.y,x=(l+p)/2,y=(f+m)/2,v=p-l,C=m-f,_=Math.sqrt(v*v+C*C);if(!(_<h+c)){l+=v*h/_,f+=C*h/_,p-=v*c/_,m-=C*c/_,x=(l+p)/2,y=(f+m)/2,v=p-l,C=m-f,_=Math.sqrt(v*v+C*C);var g=i.measureText(u).width;if(g>_){var b="\u2026";for(u=u+b,g=i.measureText(u).width;g>_&&u.length>1;)u=u.slice(0,-2)+b,g=i.measureText(u).width;if(u.length<4)return}var R;v>0?C>0?R=Math.acos(v/_):R=Math.asin(C/_):C>0?R=Math.acos(v/_)+Math.PI:R=Math.asin(v/_)+Math.PI/2,i.save(),i.translate(x,y),i.rotate(R),i.fillText(u,-g/2,t.size/2+o),i.restore()}}}Dt.default=Vo;var It={},Jr={exports:{}};(()=>{var i={d:(r,n)=>{for(var o in n)i.o(n,o)&&!i.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{default:()=>e});const e=`attribute vec2 a_position;
attribute float a_size;
attribute vec4 a_color;

uniform float u_ratio;
uniform float u_scale;
uniform mat3 u_matrix;

varying vec4 v_color;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  gl_Position = vec4(
    (u_matrix * vec3(a_position, 1)).xy,
    0,
    1
  );

  // Multiply the point size twice:
  //  - x SCALING_RATIO to correct the canvas scaling
  //  - x 2 to correct the formulae
  gl_PointSize = a_size * u_ratio * u_scale * 2.0;

  v_border = (1.0 / u_ratio) * (0.5 / a_size);

  // Extract the color:
  v_color = a_color;
  v_color.a *= bias;
}
`;Jr.exports=t})();var ei={exports:{}};(()=>{var i={d:(r,n)=>{for(var o in n)i.o(n,o)&&!i.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{default:()=>e});const e=`precision mediump float;

varying vec4 v_color;
varying float v_border;

const float radius = 0.5;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  vec2 m = gl_PointCoord - vec2(0.5, 0.5);
  float dist = radius - length(m);

  float t = 0.0;
  if (dist > v_border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / v_border;

  gl_FragColor = mix(transparent, v_color, t);
}
`;ei.exports=t})();var Le={},ke={},ye={};Object.defineProperty(ye,"__esModule",{value:!0});ye.loadProgram=ye.loadFragmentShader=ye.loadVertexShader=void 0;function ti(i,t,e){var r=i==="VERTEX"?t.VERTEX_SHADER:t.FRAGMENT_SHADER,n=t.createShader(r);if(n===null)throw new Error("loadShader: error while creating the shader");t.shaderSource(n,e),t.compileShader(n);var o=t.getShaderParameter(n,t.COMPILE_STATUS);if(!o){var a=t.getShaderInfoLog(n);throw t.deleteShader(n),new Error(`loadShader: error while compiling the shader:
`.concat(a,`
`).concat(e))}return n}function Ko(i,t){return ti("VERTEX",i,t)}ye.loadVertexShader=Ko;function Xo(i,t){return ti("FRAGMENT",i,t)}ye.loadFragmentShader=Xo;function Qo(i,t){var e=i.createProgram();if(e===null)throw new Error("loadProgram: error while creating the program.");var r,n;for(r=0,n=t.length;r<n;r++)i.attachShader(e,t[r]);i.linkProgram(e);var o=i.getProgramParameter(e,i.LINK_STATUS);if(!o)throw i.deleteProgram(e),new Error("loadProgram: error while linking the program.");return e}ye.loadProgram=Qo;Object.defineProperty(ke,"__esModule",{value:!0});ke.AbstractProgram=void 0;var dt=ye,Jo=function(){function i(t,e,r,n,o){this.array=new Float32Array,this.points=n,this.attributes=o,this.gl=t,this.vertexShaderSource=e,this.fragmentShaderSource=r;var a=t.createBuffer();if(a===null)throw new Error("AbstractProgram: error while creating the buffer");this.buffer=a,t.bindBuffer(t.ARRAY_BUFFER,this.buffer),this.vertexShader=(0,dt.loadVertexShader)(t,this.vertexShaderSource),this.fragmentShader=(0,dt.loadFragmentShader)(t,this.fragmentShaderSource),this.program=(0,dt.loadProgram)(t,[this.vertexShader,this.fragmentShader])}return i.prototype.bufferData=function(){var t=this.gl;t.bufferData(t.ARRAY_BUFFER,this.array,t.DYNAMIC_DRAW)},i.prototype.allocate=function(t){this.array=new Float32Array(this.points*this.attributes*t)},i.prototype.hasNothingToRender=function(){return this.array.length===0},i}();ke.AbstractProgram=Jo;var ea=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Le,"__esModule",{value:!0});Le.createNodeCompoundProgram=Le.AbstractNodeProgram=void 0;var ta=ke,ra=function(i){ea(t,i);function t(e,r,n,o,a){var s=i.call(this,e,r,n,o,a)||this;s.positionLocation=e.getAttribLocation(s.program,"a_position"),s.sizeLocation=e.getAttribLocation(s.program,"a_size"),s.colorLocation=e.getAttribLocation(s.program,"a_color");var d=e.getUniformLocation(s.program,"u_matrix");if(d===null)throw new Error("AbstractNodeProgram: error while getting matrixLocation");s.matrixLocation=d;var u=e.getUniformLocation(s.program,"u_ratio");if(u===null)throw new Error("AbstractNodeProgram: error while getting ratioLocation");s.ratioLocation=u;var h=e.getUniformLocation(s.program,"u_scale");if(h===null)throw new Error("AbstractNodeProgram: error while getting scaleLocation");return s.scaleLocation=h,s}return t.prototype.bind=function(){var e=this.gl;e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.sizeLocation),e.enableVertexAttribArray(this.colorLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.sizeLocation,1,e.FLOAT,!1,this.attributes*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,this.attributes*Float32Array.BYTES_PER_ELEMENT,12)},t}(ta.AbstractProgram);Le.AbstractNodeProgram=ra;function ia(i){return function(){function t(e,r){this.programs=i.map(function(n){return new n(e,r)})}return t.prototype.bufferData=function(){this.programs.forEach(function(e){return e.bufferData()})},t.prototype.allocate=function(e){this.programs.forEach(function(r){return r.allocate(e)})},t.prototype.bind=function(){},t.prototype.render=function(e){this.programs.forEach(function(r){r.bind(),r.bufferData(),r.render(e)})},t.prototype.process=function(e,r,n){this.programs.forEach(function(o){return o.process(e,r,n)})},t}()}Le.createNodeCompoundProgram=ia;var na=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ri=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(It,"__esModule",{value:!0});var oa=D,aa=ri(Jr.exports),sa=ri(ei.exports),ua=Le,Kt=1,ht=4,da=function(i){na(t,i);function t(e){var r=i.call(this,e,aa.default,sa.default,Kt,ht)||this;return r.bind(),r}return t.prototype.process=function(e,r,n){var o=this.array,a=n*Kt*ht;if(r){o[a++]=0,o[a++]=0,o[a++]=0,o[a++]=0;return}var s=(0,oa.floatColor)(e.color);o[a++]=e.x,o[a++]=e.y,o[a++]=e.size,o[a]=s},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,n=this.program;r.useProgram(n),r.uniform1f(this.ratioLocation,1/Math.sqrt(e.ratio)),r.uniform1f(this.scaleLocation,e.scalingRatio),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.drawArrays(r.POINTS,0,this.array.length/ht)}},t}(ua.AbstractNodeProgram);It.default=da;var Tt={},ii={exports:{}};(()=>{var i={d:(r,n)=>{for(var o in n)i.o(n,o)&&!i.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{default:()=>e});const e=`attribute vec4 a_color;
attribute vec2 a_normal;
attribute vec2 a_position;

uniform mat3 u_matrix;
uniform float u_sqrtZoomRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;

void main() {
  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // We require edges to be at least \`minThickness\` pixels thick *on screen*
  // (so we need to compensate the SQRT zoom ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sqrtZoomRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio;

  // Finally, we adapt the edge thickness to the "SQRT rule" in sigma (so that
  // items are not too big when zoomed in, and not too small when zoomed out).
  // The exact computation should be \`adapted = value * zoom / sqrt(zoom)\`, but
  // it's simpler like this:
  float adaptedWebGLThickness = webGLThickness * u_sqrtZoomRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(a_position + unitNormal * adaptedWebGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_sqrtZoomRatio;

  v_normal = unitNormal;
  v_color = a_color;
  v_color.a *= bias;
}
`;ii.exports=t})();var Nt={exports:{}};(()=>{var i={d:(r,n)=>{for(var o in n)i.o(n,o)&&!i.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{default:()=>e});const e=`precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;

const float feather = 0.001;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
}
`;Nt.exports=t})();var he={},ha=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(he,"__esModule",{value:!0});he.createEdgeCompoundProgram=he.AbstractEdgeProgram=void 0;var ca=ke,la=function(i){ha(t,i);function t(e,r,n,o,a){return i.call(this,e,r,n,o,a)||this}return t}(ca.AbstractProgram);he.AbstractEdgeProgram=la;function fa(i){return function(){function t(e,r){this.programs=i.map(function(n){return new n(e,r)})}return t.prototype.bufferData=function(){this.programs.forEach(function(e){return e.bufferData()})},t.prototype.allocate=function(e){this.programs.forEach(function(r){return r.allocate(e)})},t.prototype.bind=function(){},t.prototype.computeIndices=function(){this.programs.forEach(function(e){return e.computeIndices()})},t.prototype.render=function(e){this.programs.forEach(function(r){r.bind(),r.bufferData(),r.render(e)})},t.prototype.process=function(e,r,n,o,a){this.programs.forEach(function(s){return s.process(e,r,n,o,a)})},t}()}he.createEdgeCompoundProgram=fa;var ga=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ni=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Tt,"__esModule",{value:!0});var Xt=D,pa=ni(ii.exports),ya=ni(Nt.exports),ma=he,ft=4,ve=5,Qt=ft*ve,va=function(i){ga(t,i);function t(e){var r=i.call(this,e,pa.default,ya.default,ft,ve)||this,n=e.createBuffer();if(n===null)throw new Error("EdgeProgram: error while creating indicesBuffer");r.indicesBuffer=n,r.positionLocation=e.getAttribLocation(r.program,"a_position"),r.colorLocation=e.getAttribLocation(r.program,"a_color"),r.normalLocation=e.getAttribLocation(r.program,"a_normal");var o=e.getUniformLocation(r.program,"u_matrix");if(o===null)throw new Error("EdgeProgram: error while getting matrixLocation");r.matrixLocation=o;var a=e.getUniformLocation(r.program,"u_correctionRatio");if(a===null)throw new Error("EdgeProgram: error while getting correctionRatioLocation");r.correctionRatioLocation=a;var s=e.getUniformLocation(r.program,"u_sqrtZoomRatio");if(s===null)throw new Error("EdgeProgram: error while getting sqrtZoomRatioLocation");return r.sqrtZoomRatioLocation=s,r.canUse32BitsIndices=(0,Xt.canUse32BitsIndices)(e),r.IndicesArray=r.canUse32BitsIndices?Uint32Array:Uint16Array,r.indicesArray=new r.IndicesArray,r.indicesType=r.canUse32BitsIndices?e.UNSIGNED_INT:e.UNSIGNED_SHORT,r.bind(),r}return t.prototype.bind=function(){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.normalLocation),e.enableVertexAttribArray(this.colorLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,ve*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.normalLocation,2,e.FLOAT,!1,ve*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,ve*Float32Array.BYTES_PER_ELEMENT,16)},t.prototype.computeIndices=function(){for(var e=this.array.length/ve,r=e+e/2,n=new this.IndicesArray(r),o=0,a=0;o<e;o+=4)n[a++]=o,n[a++]=o+1,n[a++]=o+2,n[a++]=o+2,n[a++]=o+1,n[a++]=o+3;this.indicesArray=n},t.prototype.bufferData=function(){i.prototype.bufferData.call(this);var e=this.gl;e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indicesArray,e.STATIC_DRAW)},t.prototype.process=function(e,r,n,o,a){if(o){for(var s=a*Qt,d=s+Qt;s<d;s++)this.array[s]=0;return}var u=n.size||1,h=e.x,c=e.y,l=r.x,f=r.y,p=(0,Xt.floatColor)(n.color),m=l-h,x=f-c,y=m*m+x*x,v=0,C=0;y&&(y=1/Math.sqrt(y),v=-x*y*u,C=m*y*u);var _=ft*ve*a,g=this.array;g[_++]=h,g[_++]=c,g[_++]=v,g[_++]=C,g[_++]=p,g[_++]=h,g[_++]=c,g[_++]=-v,g[_++]=-C,g[_++]=p,g[_++]=l,g[_++]=f,g[_++]=v,g[_++]=C,g[_++]=p,g[_++]=l,g[_++]=f,g[_++]=-v,g[_++]=-C,g[_]=p},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,n=this.program;r.useProgram(n),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.uniform1f(this.sqrtZoomRatioLocation,Math.sqrt(e.ratio)),r.uniform1f(this.correctionRatioLocation,e.correctionRatio),r.drawElements(r.TRIANGLES,this.indicesArray.length,this.indicesType,0)}},t}(ma.AbstractEdgeProgram);Tt.default=va;var Pt={},Ft={},oi={exports:{}};(()=>{var i={d:(r,n)=>{for(var o in n)i.o(n,o)&&!i.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{default:()=>e});const e=`attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec4 a_color;
attribute vec3 a_barycentric;

uniform mat3 u_matrix;
uniform float u_sqrtZoomRatio;
uniform float u_correctionRatio;

varying vec4 v_color;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;
const float arrowHeadWidthLengthRatio = 0.66;
const float arrowHeadLengthThicknessRatio = 2.5;

void main() {
  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength, minThickness * u_sqrtZoomRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float adaptedWebGLThickness = webGLThickness * u_sqrtZoomRatio;
  float adaptedWebGLNodeRadius = a_radius * 2.0 * u_correctionRatio * u_sqrtZoomRatio;
  float adaptedWebGLArrowHeadLength = adaptedWebGLThickness * 2.0 * arrowHeadLengthThicknessRatio;
  float adaptedWebGLArrowHeadHalfWidth = adaptedWebGLArrowHeadLength * arrowHeadWidthLengthRatio / 2.0;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (adaptedWebGLNodeRadius * unitNormal.y)
    + db * ((adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.y + adaptedWebGLArrowHeadHalfWidth * unitNormal.x)
    + dc * ((adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.y - adaptedWebGLArrowHeadHalfWidth * unitNormal.x),

      da * (-adaptedWebGLNodeRadius * unitNormal.x)
    + db * (-(adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.x + adaptedWebGLArrowHeadHalfWidth * unitNormal.y)
    + dc * (-(adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength) * unitNormal.x - adaptedWebGLArrowHeadHalfWidth * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  // Extract the color:
  v_color = a_color;
  v_color.a *= bias;
}
`;oi.exports=t})();var ai={exports:{}};(()=>{var i={d:(r,n)=>{for(var o in n)i.o(n,o)&&!i.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{default:()=>e});const e=`precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`;ai.exports=t})();var wa=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),si=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ft,"__esModule",{value:!0});var ba=D,_a=si(oi.exports),Ea=si(ai.exports),Aa=he,gt=3,ue=9,Jt=gt*ue,xa=function(i){wa(t,i);function t(e){var r=i.call(this,e,_a.default,Ea.default,gt,ue)||this;r.positionLocation=e.getAttribLocation(r.program,"a_position"),r.colorLocation=e.getAttribLocation(r.program,"a_color"),r.normalLocation=e.getAttribLocation(r.program,"a_normal"),r.radiusLocation=e.getAttribLocation(r.program,"a_radius"),r.barycentricLocation=e.getAttribLocation(r.program,"a_barycentric");var n=e.getUniformLocation(r.program,"u_matrix");if(n===null)throw new Error("EdgeArrowHeadProgram: error while getting matrixLocation");r.matrixLocation=n;var o=e.getUniformLocation(r.program,"u_sqrtZoomRatio");if(o===null)throw new Error("EdgeArrowHeadProgram: error while getting sqrtZoomRatioLocation");r.sqrtZoomRatioLocation=o;var a=e.getUniformLocation(r.program,"u_correctionRatio");if(a===null)throw new Error("EdgeArrowHeadProgram: error while getting correctionRatioLocation");return r.correctionRatioLocation=a,r.bind(),r}return t.prototype.bind=function(){var e=this.gl;e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.normalLocation),e.enableVertexAttribArray(this.radiusLocation),e.enableVertexAttribArray(this.colorLocation),e.enableVertexAttribArray(this.barycentricLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,ue*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.normalLocation,2,e.FLOAT,!1,ue*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.radiusLocation,1,e.FLOAT,!1,ue*Float32Array.BYTES_PER_ELEMENT,16),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,ue*Float32Array.BYTES_PER_ELEMENT,20),e.vertexAttribPointer(this.barycentricLocation,3,e.FLOAT,!1,ue*Float32Array.BYTES_PER_ELEMENT,24)},t.prototype.computeIndices=function(){},t.prototype.process=function(e,r,n,o,a){if(o){for(var s=a*Jt,d=s+Jt;s<d;s++)this.array[s]=0;return}var u=n.size||1,h=r.size||1,c=e.x,l=e.y,f=r.x,p=r.y,m=(0,ba.floatColor)(n.color),x=f-c,y=p-l,v=x*x+y*y,C=0,_=0;v&&(v=1/Math.sqrt(v),C=-y*v*u,_=x*v*u);var g=gt*ue*a,b=this.array;b[g++]=f,b[g++]=p,b[g++]=-C,b[g++]=-_,b[g++]=h,b[g++]=m,b[g++]=1,b[g++]=0,b[g++]=0,b[g++]=f,b[g++]=p,b[g++]=-C,b[g++]=-_,b[g++]=h,b[g++]=m,b[g++]=0,b[g++]=1,b[g++]=0,b[g++]=f,b[g++]=p,b[g++]=-C,b[g++]=-_,b[g++]=h,b[g++]=m,b[g++]=0,b[g++]=0,b[g]=1},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,n=this.program;r.useProgram(n),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.uniform1f(this.sqrtZoomRatioLocation,Math.sqrt(e.ratio)),r.uniform1f(this.correctionRatioLocation,e.correctionRatio),r.drawArrays(r.TRIANGLES,0,this.array.length/ue)}},t}(Aa.AbstractEdgeProgram);Ft.default=xa;var Gt={},ui={exports:{}};(()=>{var i={d:(r,n)=>{for(var o in n)i.o(n,o)&&!i.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(r,n)=>Object.prototype.hasOwnProperty.call(r,n),r:r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{default:()=>e});const e=`attribute vec4 a_color;
attribute vec2 a_normal;
attribute vec2 a_position;
attribute float a_radius;

uniform mat3 u_matrix;
uniform float u_sqrtZoomRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;
const float arrowHeadLengthThicknessRatio = 2.5;

void main() {
  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sqrtZoomRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float adaptedWebGLThickness = webGLThickness * u_sqrtZoomRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(a_radius);
  float adaptedWebGLNodeRadius = direction * a_radius * 2.0 * u_correctionRatio * u_sqrtZoomRatio;
  float adaptedWebGLArrowHeadLength = adaptedWebGLThickness * 2.0 * arrowHeadLengthThicknessRatio;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (adaptedWebGLNodeRadius + adaptedWebGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(a_position + unitNormal * adaptedWebGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_sqrtZoomRatio;

  v_normal = unitNormal;
  v_color = a_color;
  v_color.a *= bias;
}
`;ui.exports=t})();var Ca=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),di=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Gt,"__esModule",{value:!0});var La=he,er=D,Sa=di(ui.exports),Da=di(Nt.exports),pt=4,pe=6,tr=pt*pe,Ia=function(i){Ca(t,i);function t(e){var r=i.call(this,e,Sa.default,Da.default,pt,pe)||this,n=e.createBuffer();if(n===null)throw new Error("EdgeClampedProgram: error while getting resolutionLocation");r.indicesBuffer=n,r.positionLocation=e.getAttribLocation(r.program,"a_position"),r.colorLocation=e.getAttribLocation(r.program,"a_color"),r.normalLocation=e.getAttribLocation(r.program,"a_normal"),r.radiusLocation=e.getAttribLocation(r.program,"a_radius");var o=e.getUniformLocation(r.program,"u_matrix");if(o===null)throw new Error("EdgeClampedProgram: error while getting matrixLocation");r.matrixLocation=o;var a=e.getUniformLocation(r.program,"u_sqrtZoomRatio");if(a===null)throw new Error("EdgeClampedProgram: error while getting cameraRatioLocation");r.sqrtZoomRatioLocation=a;var s=e.getUniformLocation(r.program,"u_correctionRatio");if(s===null)throw new Error("EdgeClampedProgram: error while getting viewportRatioLocation");return r.correctionRatioLocation=s,r.canUse32BitsIndices=(0,er.canUse32BitsIndices)(e),r.IndicesArray=r.canUse32BitsIndices?Uint32Array:Uint16Array,r.indicesArray=new r.IndicesArray,r.indicesType=r.canUse32BitsIndices?e.UNSIGNED_INT:e.UNSIGNED_SHORT,r.bind(),r}return t.prototype.bind=function(){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.normalLocation),e.enableVertexAttribArray(this.colorLocation),e.enableVertexAttribArray(this.radiusLocation),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,pe*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(this.normalLocation,2,e.FLOAT,!1,pe*Float32Array.BYTES_PER_ELEMENT,8),e.vertexAttribPointer(this.colorLocation,4,e.UNSIGNED_BYTE,!0,pe*Float32Array.BYTES_PER_ELEMENT,16),e.vertexAttribPointer(this.radiusLocation,1,e.FLOAT,!1,pe*Float32Array.BYTES_PER_ELEMENT,20)},t.prototype.process=function(e,r,n,o,a){if(o){for(var s=a*tr,d=s+tr;s<d;s++)this.array[s]=0;return}var u=n.size||1,h=e.x,c=e.y,l=r.x,f=r.y,p=r.size||1,m=(0,er.floatColor)(n.color),x=l-h,y=f-c,v=x*x+y*y,C=0,_=0;v&&(v=1/Math.sqrt(v),C=-y*v*u,_=x*v*u);var g=pt*pe*a,b=this.array;b[g++]=h,b[g++]=c,b[g++]=C,b[g++]=_,b[g++]=m,b[g++]=0,b[g++]=h,b[g++]=c,b[g++]=-C,b[g++]=-_,b[g++]=m,b[g++]=0,b[g++]=l,b[g++]=f,b[g++]=C,b[g++]=_,b[g++]=m,b[g++]=p,b[g++]=l,b[g++]=f,b[g++]=-C,b[g++]=-_,b[g++]=m,b[g]=-p},t.prototype.computeIndices=function(){for(var e=this.array.length/pe,r=e+e/2,n=new this.IndicesArray(r),o=0,a=0;o<e;o+=4)n[a++]=o,n[a++]=o+1,n[a++]=o+2,n[a++]=o+2,n[a++]=o+1,n[a++]=o+3;this.indicesArray=n},t.prototype.bufferData=function(){i.prototype.bufferData.call(this);var e=this.gl;e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indicesArray,e.STATIC_DRAW)},t.prototype.render=function(e){if(!this.hasNothingToRender()){var r=this.gl,n=this.program;r.useProgram(n),r.uniformMatrix3fv(this.matrixLocation,!1,e.matrix),r.uniform1f(this.sqrtZoomRatioLocation,Math.sqrt(e.ratio)),r.uniform1f(this.correctionRatioLocation,e.correctionRatio),r.drawElements(r.TRIANGLES,this.indicesArray.length,this.indicesType,0)}},t}(La.AbstractEdgeProgram);Gt.default=Ia;var hi=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Pt,"__esModule",{value:!0});var Ta=he,Na=hi(Ft),Pa=hi(Gt),Fa=(0,Ta.createEdgeCompoundProgram)([Pa.default,Na.default]);Pt.default=Fa;(function(i){var t=E&&E.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(i,"__esModule",{value:!0}),i.resolveSettings=i.validateSettings=i.DEFAULT_EDGE_PROGRAM_CLASSES=i.DEFAULT_NODE_PROGRAM_CLASSES=i.DEFAULT_SETTINGS=void 0;var e=D,r=t(it),n=t(St),o=t(Dt),a=t(It),s=t(Tt),d=t(Pt);i.DEFAULT_SETTINGS={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeClickEvents:!1,enableEdgeWheelEvents:!1,enableEdgeHoverEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,labelRenderer:r.default,hoverRenderer:n.default,edgeLabelRenderer:o.default,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},i.DEFAULT_NODE_PROGRAM_CLASSES={circle:a.default},i.DEFAULT_EDGE_PROGRAM_CLASSES={arrow:d.default,line:s.default};function u(c){if(typeof c.labelDensity!="number"||c.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var l=c.minCameraRatio,f=c.maxCameraRatio;if(typeof l=="number"&&typeof f=="number"&&f<l)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}i.validateSettings=u;function h(c){var l=(0,e.assign)({},i.DEFAULT_SETTINGS,c);return l.nodeProgramClasses=(0,e.assign)({},i.DEFAULT_NODE_PROGRAM_CLASSES,l.nodeProgramClasses),l.edgeProgramClasses=(0,e.assign)({},i.DEFAULT_EDGE_PROGRAM_CLASSES,l.edgeProgramClasses),l}i.resolveSettings=h})(Qr);var Mt={},Ga=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ma=E&&E.__createBinding||(Object.create?function(i,t,e,r){r===void 0&&(r=e),Object.defineProperty(i,r,{enumerable:!0,get:function(){return t[e]}})}:function(i,t,e,r){r===void 0&&(r=e),i[r]=t[e]}),Ra=E&&E.__setModuleDefault||(Object.create?function(i,t){Object.defineProperty(i,"default",{enumerable:!0,value:t})}:function(i,t){i.default=t}),Oa=E&&E.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)e!=="default"&&Object.prototype.hasOwnProperty.call(i,e)&&Ma(t,i,e);return Ra(t,i),t},rr=E&&E.__read||function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),n,o=[],a;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(s){a={error:s}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(a)throw a.error}}return o};Object.defineProperty(Mt,"__esModule",{value:!0});var ge=Oa(B),$a=200,ir=3,ka=200,Ua=function(i){Ga(t,i);function t(e,r){var n=i.call(this,e,r)||this;return n.enabled=!0,n.isMoving=!1,n.hasMoved=!1,n.touchMode=0,n.startTouchesPositions=[],n.handleStart=n.handleStart.bind(n),n.handleLeave=n.handleLeave.bind(n),n.handleMove=n.handleMove.bind(n),e.addEventListener("touchstart",n.handleStart,!1),e.addEventListener("touchend",n.handleLeave,!1),e.addEventListener("touchcancel",n.handleLeave,!1),e.addEventListener("touchmove",n.handleMove,!1),n}return t.prototype.kill=function(){var e=this.container;e.removeEventListener("touchstart",this.handleStart),e.removeEventListener("touchend",this.handleLeave),e.removeEventListener("touchcancel",this.handleLeave),e.removeEventListener("touchmove",this.handleMove)},t.prototype.getDimensions=function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}},t.prototype.dispatchRelatedMouseEvent=function(e,r,n,o){var a=n||r.touches[0],s=new MouseEvent(e,{clientX:a.clientX,clientY:a.clientY,altKey:r.altKey,ctrlKey:r.ctrlKey});s.isFakeSigmaMouseEvent=!0,(o||this.container).dispatchEvent(s)},t.prototype.handleStart=function(e){var r=this;if(!!this.enabled){e.preventDefault(),e.touches.length===1&&this.dispatchRelatedMouseEvent("mousedown",e);var n=(0,ge.getTouchesArray)(e.touches);if(this.touchMode=n.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=n.map(function(l){return(0,ge.getPosition)(l,r.container)}),this.lastTouches=n,this.lastTouchesPositions=this.startTouchesPositions,this.touchMode===2){var o=rr(this.startTouchesPositions,2),a=o[0],s=a.x,d=a.y,u=o[1],h=u.x,c=u.y;this.startTouchesAngle=Math.atan2(c-d,h-s),this.startTouchesDistance=Math.sqrt(Math.pow(h-s,2)+Math.pow(c-d,2))}this.emit("touchdown",(0,ge.getTouchCoords)(e,this.container))}},t.prototype.handleLeave=function(e){if(!!this.enabled){switch(e.preventDefault(),e.touches.length===0&&this.lastTouches&&this.lastTouches.length&&(this.dispatchRelatedMouseEvent("mouseup",e,this.lastTouches[0],document),this.hasMoved||this.dispatchRelatedMouseEvent("click",e,this.lastTouches[0])),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(e.touches.length===1){this.handleStart(e),e.preventDefault();break}case 1:if(this.isMoving){var r=this.renderer.getCamera(),n=r.getState(),o=r.getPreviousState()||{x:0,y:0};r.animate({x:n.x+ir*(n.x-o.x),y:n.y+ir*(n.y-o.y)},{duration:ka,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}this.emit("touchup",(0,ge.getTouchCoords)(e,this.container))}},t.prototype.handleMove=function(e){var r,n=this;if(!!this.enabled){e.preventDefault(),e.touches.length===1&&this.dispatchRelatedMouseEvent("mousemove",e);var o=(0,ge.getTouchesArray)(e.touches),a=o.map(function(fe){return(0,ge.getPosition)(fe,n.container)});if(this.lastTouches=o,this.lastTouchesPositions=a,this.hasMoved||(this.hasMoved=a.some(function(fe,we){var O=n.startTouchesPositions[we];return fe.x!==O.x||fe.y!==O.y})),!!this.hasMoved){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){n.isMoving=!1},$a);var s=this.renderer.getCamera(),d=this.startCameraState;switch(this.touchMode){case 1:{var u=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),h=u.x,c=u.y,l=this.renderer.viewportToFramedGraph(a[0]),f=l.x,p=l.y;s.setState({x:d.x+h-f,y:d.y+c-p});break}case 2:{var m={},x=a[0],y=x.x,v=x.y,C=a[1],_=C.x,g=C.y,b=Math.atan2(g-v,_-y)-this.startTouchesAngle,R=Math.hypot(g-v,_-y)/this.startTouchesDistance,ee=s.getBoundedRatio(d.ratio/R);m.ratio=ee,m.angle=d.angle+b;var j=this.getDimensions(),Q=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:d}),k=Math.min(j.width,j.height),ne=k/j.width,me=k/j.height,le=ee/k,f=y-k/2/ne,p=v-k/2/me;r=rr([f*Math.cos(-m.angle)-p*Math.sin(-m.angle),p*Math.cos(-m.angle)+f*Math.sin(-m.angle)],2),f=r[0],p=r[1],m.x=Q.x-f*le,m.y=Q.y+p*le,s.setState(m);break}}this.emit("touchmove",(0,ge.getTouchCoords)(e,this.container))}}},t}(ge.default);Mt.default=Ua;var Se={};Object.defineProperty(Se,"__esModule",{value:!0});Se.doEdgeCollideWithPoint=Se.isPixelColored=void 0;function za(i,t,e){var r=new Uint8Array(4);return i.readPixels(t,i.drawingBufferHeight-e,1,1,i.RGBA,i.UNSIGNED_BYTE,r),r[3]>0}Se.isPixelColored=za;function ja(i,t,e,r,n,o,a){if(i<e-a&&i<n-a||t<r-a&&t<o-a||i>e+a&&i>n+a||t>r+a&&t>o+a)return!1;var s=Math.abs((n-e)*(r-t)-(e-i)*(o-r))/Math.sqrt(Math.pow(n-e,2)+Math.pow(o-r,2));return s<a/2}Se.doEdgeCollideWithPoint=ja;var Ba=E&&E.__extends||function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),T=E&&E.__assign||function(){return T=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},T.apply(this,arguments)},Wa=E&&E.__values||function(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ue=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Et,"__esModule",{value:!0});var Ha=Ue(Ur),nr=Ue(et),qa=Ue(rt),or=Ue(re),Za=Te,G=D,ar=Ce,He=Qr,Ya=Ue(Mt),qe=W,sr=Se,ur=150,dr=50;function Va(i,t,e){if(!e.hasOwnProperty("x")||!e.hasOwnProperty("y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(t,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return e.color||(e.color=i.defaultNodeColor),!e.label&&e.label!==""&&(e.label=null),e.label!==void 0&&e.label!==null?e.label=""+e.label:e.label=null,e.size||(e.size=2),e.hasOwnProperty("hidden")||(e.hidden=!1),e.hasOwnProperty("highlighted")||(e.highlighted=!1),e.hasOwnProperty("forceLabel")||(e.forceLabel=!1),(!e.type||e.type==="")&&(e.type=i.defaultNodeType),e.zIndex||(e.zIndex=0),e}function Ka(i,t,e){return e.color||(e.color=i.defaultEdgeColor),e.label||(e.label=""),e.size||(e.size=.5),e.hasOwnProperty("hidden")||(e.hidden=!1),e.hasOwnProperty("forceLabel")||(e.forceLabel=!1),(!e.type||e.type==="")&&(e.type=i.defaultEdgeType),e.zIndex||(e.zIndex=0),e}var Xa=function(i){Ba(t,i);function t(e,r,n){n===void 0&&(n={});var o=i.call(this)||this;if(o.elements={},o.canvasContexts={},o.webGLContexts={},o.activeListeners={},o.quadtree=new or.default,o.labelGrid=new ar.LabelGrid,o.nodeDataCache={},o.edgeDataCache={},o.nodesWithForcedLabels=[],o.edgesWithForcedLabels=[],o.nodeExtent={x:[0,1],y:[0,1]},o.matrix=(0,qe.identity)(),o.invMatrix=(0,qe.identity)(),o.correctionRatio=1,o.customBBox=null,o.normalizationFunction=(0,G.createNormalizationFunction)({x:[0,1],y:[0,1]}),o.cameraSizeRatio=1,o.width=0,o.height=0,o.pixelRatio=(0,G.getPixelRatio)(),o.displayedLabels=new Set,o.highlightedNodes=new Set,o.hoveredNode=null,o.hoveredEdge=null,o.renderFrame=null,o.renderHighlightedNodesFrame=null,o.needToProcess=!1,o.needToSoftProcess=!1,o.checkEdgesEventsFrame=null,o.nodePrograms={},o.nodeHoverPrograms={},o.edgePrograms={},o.settings=(0,He.resolveSettings)(n),(0,He.validateSettings)(o.settings),(0,G.validateGraph)(e),!(r instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");o.graph=e,o.container=r,o.createWebGLContext("edges",{preserveDrawingBuffer:!0}),o.createCanvasContext("edgeLabels"),o.createWebGLContext("nodes"),o.createCanvasContext("labels"),o.createCanvasContext("hovers"),o.createWebGLContext("hoverNodes"),o.createCanvasContext("mouse");for(var a in o.webGLContexts){var s=o.webGLContexts[a];s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.enable(s.BLEND)}for(var d in o.settings.nodeProgramClasses){var u=o.settings.nodeProgramClasses[d];o.nodePrograms[d]=new u(o.webGLContexts.nodes,o);var h=u;d in o.settings.nodeHoverProgramClasses&&(h=o.settings.nodeHoverProgramClasses[d]),o.nodeHoverPrograms[d]=new h(o.webGLContexts.hoverNodes,o)}for(var d in o.settings.edgeProgramClasses){var c=o.settings.edgeProgramClasses[d];o.edgePrograms[d]=new c(o.webGLContexts.edges,o)}return o.resize(),o.camera=new nr.default,o.bindCameraHandlers(),o.mouseCaptor=new qa.default(o.elements.mouse,o),o.touchCaptor=new Ya.default(o.elements.mouse,o),o.bindEventHandlers(),o.bindGraphHandlers(),o.handleSettingsUpdate(),o.process(),o.render(),o}return t.prototype.createCanvas=function(e){var r=(0,G.createElement)("canvas",{position:"absolute"},{class:"sigma-".concat(e)});return this.elements[e]=r,this.container.appendChild(r),r},t.prototype.createCanvasContext=function(e){var r=this.createCanvas(e),n={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[e]=r.getContext("2d",n),this},t.prototype.createWebGLContext=function(e,r){var n=this.createCanvas(e),o=T({preserveDrawingBuffer:!1,antialias:!1},r||{}),a;return a=n.getContext("webgl2",o),a||(a=n.getContext("webgl",o)),a||(a=n.getContext("experimental-webgl",o)),this.webGLContexts[e]=a,this},t.prototype.bindCameraHandlers=function(){var e=this;return this.activeListeners.camera=function(){e._scheduleRefresh()},this.camera.on("updated",this.activeListeners.camera),this},t.prototype.mouseIsOnNode=function(e,r,n){var o=e.x,a=e.y,s=r.x,d=r.y;return o>s-n&&o<s+n&&a>d-n&&a<d+n&&Math.sqrt(Math.pow(o-s,2)+Math.pow(a-d,2))<n},t.prototype.getQuadNodes=function(e){var r=this.viewportToFramedGraph(e);return this.quadtree.point(r.x,1-r.y)},t.prototype.getNodeAtPosition=function(e){for(var r=e.x,n=e.y,o=this.getQuadNodes(e),a=1/0,s=null,d=0,u=o.length;d<u;d++){var h=o[d],c=this.nodeDataCache[h],l=this.framedGraphToViewport(c),f=this.scaleSize(c.size);if(!c.hidden&&this.mouseIsOnNode(e,l,f)){var p=Math.sqrt(Math.pow(r-l.x,2)+Math.pow(n-l.y,2));p<a&&(a=p,s=h)}}return s},t.prototype.bindEventHandlers=function(){var e=this;this.activeListeners.handleResize=function(){e.needToSoftProcess=!0,e._scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(n){var o={event:n,preventSigmaDefault:function(){n.preventSigmaDefault()}},a=e.getNodeAtPosition(n);if(a&&e.hoveredNode!==a&&!e.nodeDataCache[a].hidden){e.hoveredNode&&e.emit("leaveNode",T(T({},o),{node:e.hoveredNode})),e.hoveredNode=a,e.emit("enterNode",T(T({},o),{node:a})),e.scheduleHighlightedNodesRender();return}if(e.hoveredNode){var s=e.nodeDataCache[e.hoveredNode],d=e.framedGraphToViewport(s),u=e.scaleSize(s.size);if(!e.mouseIsOnNode(n,d,u)){var h=e.hoveredNode;e.hoveredNode=null,e.emit("leaveNode",T(T({},o),{node:h})),e.scheduleHighlightedNodesRender();return}}e.settings.enableEdgeHoverEvents===!0?e.checkEdgeHoverEvents(o):e.settings.enableEdgeHoverEvents==="debounce"&&(e.checkEdgesEventsFrame||(e.checkEdgesEventsFrame=(0,G.requestFrame)(function(){e.checkEdgeHoverEvents(o),e.checkEdgesEventsFrame=null})))};var r=function(n){return function(o){var a={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}},s=o.original.isFakeSigmaMouseEvent,d=s?e.getNodeAtPosition(o):e.hoveredNode;if(d)return e.emit("".concat(n,"Node"),T(T({},a),{node:d}));if(n==="wheel"?e.settings.enableEdgeWheelEvents:e.settings.enableEdgeClickEvents){var u=e.getEdgeAtPoint(o.x,o.y);if(u)return e.emit("".concat(n,"Edge"),T(T({},a),{edge:u}))}return e.emit("".concat(n,"Stage"),a)}};return this.activeListeners.handleClick=r("click"),this.activeListeners.handleRightClick=r("rightClick"),this.activeListeners.handleDoubleClick=r("doubleClick"),this.activeListeners.handleWheel=r("wheel"),this.activeListeners.handleDown=r("down"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this},t.prototype.bindGraphHandlers=function(){var e=this,r=this.graph;return this.activeListeners.graphUpdate=function(){e.needToProcess=!0,e._scheduleRefresh()},this.activeListeners.softGraphUpdate=function(){e.needToSoftProcess=!0,e._scheduleRefresh()},this.activeListeners.dropNodeGraphUpdate=function(n){delete e.nodeDataCache[n.key],e.hoveredNode===n.key&&(e.hoveredNode=null),e.activeListeners.graphUpdate()},this.activeListeners.dropEdgeGraphUpdate=function(n){delete e.edgeDataCache[n.key],e.hoveredEdge===n.key&&(e.hoveredEdge=null),e.activeListeners.graphUpdate()},this.activeListeners.clearEdgesGraphUpdate=function(){e.edgeDataCache={},e.hoveredEdge=null,e.activeListeners.graphUpdate()},this.activeListeners.clearGraphUpdate=function(){e.nodeDataCache={},e.hoveredNode=null,e.activeListeners.clearEdgesGraphUpdate()},r.on("nodeAdded",this.activeListeners.graphUpdate),r.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),r.on("nodeAttributesUpdated",this.activeListeners.softGraphUpdate),r.on("eachNodeAttributesUpdated",this.activeListeners.graphUpdate),r.on("edgeAdded",this.activeListeners.graphUpdate),r.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),r.on("edgeAttributesUpdated",this.activeListeners.softGraphUpdate),r.on("eachEdgeAttributesUpdated",this.activeListeners.graphUpdate),r.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),r.on("cleared",this.activeListeners.clearGraphUpdate),this},t.prototype.unbindGraphHandlers=function(){var e=this.graph;e.removeListener("nodeAdded",this.activeListeners.graphUpdate),e.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),e.removeListener("nodeAttributesUpdated",this.activeListeners.softGraphUpdate),e.removeListener("eachNodeAttributesUpdated",this.activeListeners.graphUpdate),e.removeListener("edgeAdded",this.activeListeners.graphUpdate),e.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),e.removeListener("edgeAttributesUpdated",this.activeListeners.softGraphUpdate),e.removeListener("eachEdgeAttributesUpdated",this.activeListeners.graphUpdate),e.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),e.removeListener("cleared",this.activeListeners.clearGraphUpdate)},t.prototype.checkEdgeHoverEvents=function(e){var r=this.hoveredNode?null:this.getEdgeAtPoint(e.event.x,e.event.y);return r!==this.hoveredEdge&&(this.hoveredEdge&&this.emit("leaveEdge",T(T({},e),{edge:this.hoveredEdge})),r&&this.emit("enterEdge",T(T({},e),{edge:r})),this.hoveredEdge=r),this},t.prototype.getEdgeAtPoint=function(e,r){var n,o,a=this,s=this,d=s.edgeDataCache,u=s.nodeDataCache;if(!(0,sr.isPixelColored)(this.webGLContexts.edges,e*this.pixelRatio,r*this.pixelRatio))return null;var h=this.viewportToGraph({x:e,y:r}),c=h.x,l=h.y,f=0;if(this.graph.someEdge(function(g,b,R,ee,j,Q){var k=j.x,ne=j.y,me=Q.x,le=Q.y;if(d[g].hidden||u[R].hidden||u[ee].hidden)return!1;if(k!==me||ne!==le){var fe=Math.sqrt(Math.pow(me-k,2)+Math.pow(le-ne,2)),we=a.graphToViewport({x:k,y:ne}),O=we.x,ot=we.y,Ne=a.graphToViewport({x:me,y:le}),gi=Ne.x,pi=Ne.y,yi=Math.sqrt(Math.pow(gi-O,2)+Math.pow(pi-ot,2));return f=fe/yi,!0}}),!f)return null;var p=this.graph.filterEdges(function(g,b,R,ee,j,Q){if(d[g].hidden||u[R].hidden||u[ee].hidden)return!1;if((0,sr.doEdgeCollideWithPoint)(c,l,j.x,j.y,Q.x,Q.y,d[g].size*f/a.cameraSizeRatio))return!0});if(p.length===0)return null;var m=p[p.length-1],x=-1/0;try{for(var y=Wa(p),v=y.next();!v.done;v=y.next()){var C=v.value,_=this.graph.getEdgeAttribute(C,"zIndex");_>=x&&(m=C,x=_)}}catch(g){n={error:g}}finally{try{v&&!v.done&&(o=y.return)&&o.call(y)}finally{if(n)throw n.error}}return m},t.prototype.process=function(e){var r=this;e===void 0&&(e=!1);var n=this.graph,o=this.settings,a=this.getDimensions(),s=[1/0,-1/0],d=[1/0,-1/0];this.quadtree.clear(),this.labelGrid.resizeAndClear(a,o.labelGridCellSize),this.highlightedNodes=new Set,this.nodeExtent=(0,G.graphExtent)(n),this.nodesWithForcedLabels=[],this.edgesWithForcedLabels=[];var u=new nr.default,h=(0,G.matrixFromCamera)(u.getState(),this.getDimensions(),this.getGraphDimensions(),this.getSetting("stagePadding")||0);this.normalizationFunction=(0,G.createNormalizationFunction)(this.customBBox||this.nodeExtent);for(var c={},l=n.nodes(),f=0,p=l.length;f<p;f++){var m=l[f],x=Object.assign({},n.getNodeAttributes(m));o.nodeReducer&&(x=o.nodeReducer(m,x));var y=Va(this.settings,m,x);c[y.type]=(c[y.type]||0)+1,this.nodeDataCache[m]=y,this.normalizationFunction.applyTo(y),y.forceLabel&&this.nodesWithForcedLabels.push(m),this.settings.zIndex&&(y.zIndex<s[0]&&(s[0]=y.zIndex),y.zIndex>s[1]&&(s[1]=y.zIndex))}for(var v in this.nodePrograms){if(!this.nodePrograms.hasOwnProperty(v))throw new Error('Sigma: could not find a suitable program for node type "'.concat(v,'"!'));e||this.nodePrograms[v].allocate(c[v]||0),c[v]=0}this.settings.zIndex&&s[0]!==s[1]&&(l=(0,G.zIndexOrdering)(s,function(ne){return r.nodeDataCache[ne].zIndex},l));for(var f=0,p=l.length;f<p;f++){var m=l[f],y=this.nodeDataCache[m];this.quadtree.add(m,y.x,1-y.y,y.size/this.width),typeof y.label=="string"&&!y.hidden&&this.labelGrid.add(m,y.size,this.framedGraphToViewport(y,{matrix:h}));var C=this.nodePrograms[y.type];if(!C)throw new Error('Sigma: could not find a suitable program for node type "'.concat(y.type,'"!'));C.process(y,y.hidden,c[y.type]++),y.highlighted&&!y.hidden&&this.highlightedNodes.add(m)}this.labelGrid.organize();for(var _={},g=n.edges(),f=0,p=g.length;f<p;f++){var b=g[f],x=Object.assign({},n.getEdgeAttributes(b));o.edgeReducer&&(x=o.edgeReducer(b,x));var y=Ka(this.settings,b,x);_[y.type]=(_[y.type]||0)+1,this.edgeDataCache[b]=y,y.forceLabel&&!y.hidden&&this.edgesWithForcedLabels.push(b),this.settings.zIndex&&(y.zIndex<d[0]&&(d[0]=y.zIndex),y.zIndex>d[1]&&(d[1]=y.zIndex))}for(var v in this.edgePrograms){if(!this.edgePrograms.hasOwnProperty(v))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(v,'"!'));e||this.edgePrograms[v].allocate(_[v]||0),_[v]=0}this.settings.zIndex&&d[0]!==d[1]&&(g=(0,G.zIndexOrdering)(d,function(ne){return r.edgeDataCache[ne].zIndex},g));for(var f=0,p=g.length;f<p;f++){var b=g[f],y=this.edgeDataCache[b],R=n.extremities(b),ee=this.nodeDataCache[R[0]],j=this.nodeDataCache[R[1]],Q=y.hidden||ee.hidden||j.hidden;this.edgePrograms[y.type].process(ee,j,y,Q,_[y.type]++)}for(var v in this.edgePrograms){var k=this.edgePrograms[v];!e&&typeof k.computeIndices=="function"&&k.computeIndices()}return this},t.prototype.handleSettingsUpdate=function(){return this.camera.minRatio=this.settings.minCameraRatio,this.camera.maxRatio=this.settings.maxCameraRatio,this.camera.setState(this.camera.validateState(this.camera.getState())),this},t.prototype._refresh=function(){return this.needToProcess?this.process():this.needToSoftProcess&&this.process(!0),this.needToProcess=!1,this.needToSoftProcess=!1,this.render(),this},t.prototype._scheduleRefresh=function(){var e=this;return this.renderFrame||(this.renderFrame=(0,G.requestFrame)(function(){e._refresh(),e.renderFrame=null})),this},t.prototype.renderLabels=function(){if(!this.settings.renderLabels)return this;var e=this.camera.getState(),r=this.labelGrid.getLabelsToDisplay(e.ratio,this.settings.labelDensity);(0,Ha.default)(r,this.nodesWithForcedLabels),this.displayedLabels=new Set;for(var n=this.canvasContexts.labels,o=0,a=r.length;o<a;o++){var s=r[o],d=this.nodeDataCache[s];if(!this.displayedLabels.has(s)&&!d.hidden){var u=this.framedGraphToViewport(d),h=u.x,c=u.y,l=this.scaleSize(d.size);!d.forceLabel&&l<this.settings.labelRenderedSizeThreshold||h<-ur||h>this.width+ur||c<-dr||c>this.height+dr||(this.displayedLabels.add(s),this.settings.labelRenderer(n,T(T({key:s},d),{size:l,x:h,y:c}),this.settings))}}return this},t.prototype.renderEdgeLabels=function(){if(!this.settings.renderEdgeLabels)return this;var e=this.canvasContexts.edgeLabels;e.clearRect(0,0,this.width,this.height);for(var r=(0,ar.edgeLabelsToDisplayFromNodes)({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedLabels,highlightedNodes:this.highlightedNodes}).concat(this.edgesWithForcedLabels),n=new Set,o=0,a=r.length;o<a;o++){var s=r[o],d=this.graph.extremities(s),u=this.nodeDataCache[d[0]],h=this.nodeDataCache[d[1]],c=this.edgeDataCache[s];n.has(s)||c.hidden||u.hidden||h.hidden||(this.settings.edgeLabelRenderer(e,T(T({key:s},c),{size:this.scaleSize(c.size)}),T(T(T({key:d[0]},u),this.framedGraphToViewport(u)),{size:this.scaleSize(u.size)}),T(T(T({key:d[1]},h),this.framedGraphToViewport(h)),{size:this.scaleSize(h.size)}),this.settings),n.add(s))}return this},t.prototype.renderHighlightedNodes=function(){var e=this,r=this.canvasContexts.hovers;r.clearRect(0,0,this.width,this.height);var n=function(u){var h=e.nodeDataCache[u],c=e.framedGraphToViewport(h),l=c.x,f=c.y,p=e.scaleSize(h.size);e.settings.hoverRenderer(r,T(T({key:u},h),{size:p,x:l,y:f}),e.settings)},o=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&o.push(this.hoveredNode),this.highlightedNodes.forEach(function(u){u!==e.hoveredNode&&o.push(u)}),o.forEach(function(u){return n(u)});var a={};o.forEach(function(u){var h=e.nodeDataCache[u].type;a[h]=(a[h]||0)+1});for(var s in this.nodeHoverPrograms)this.nodeHoverPrograms[s].allocate(a[s]||0),a[s]=0;o.forEach(function(u){var h=e.nodeDataCache[u];e.nodeHoverPrograms[h.type].process(h,h.hidden,a[h.type]++)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);for(var s in this.nodeHoverPrograms){var d=this.nodeHoverPrograms[s];d.bind(),d.bufferData(),d.render({matrix:this.matrix,width:this.width,height:this.height,ratio:this.camera.ratio,correctionRatio:this.correctionRatio/this.camera.ratio,scalingRatio:this.pixelRatio})}},t.prototype.scheduleHighlightedNodesRender=function(){var e=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=(0,G.requestFrame)(function(){e.renderHighlightedNodesFrame=null,e.renderHighlightedNodes(),e.renderEdgeLabels()}))},t.prototype.render=function(){var e=this;this.emit("beforeRender");var r=function(){return e.emit("afterRender"),e};if(this.renderFrame&&((0,G.cancelFrame)(this.renderFrame),this.renderFrame=null,this.needToProcess=!1,this.needToSoftProcess=!1),this.resize(),this.clear(),this.updateCachedValues(),!this.graph.order)return r();var n=this.mouseCaptor,o=this.camera.isAnimated()||n.isMoving||n.draggedEvents||n.currentWheelDirection,a=this.camera.getState(),s=this.getDimensions(),d=this.getGraphDimensions(),u=this.getSetting("stagePadding")||0;this.matrix=(0,G.matrixFromCamera)(a,s,d,u),this.invMatrix=(0,G.matrixFromCamera)(a,s,d,u,!0),this.correctionRatio=(0,G.getMatrixImpact)(this.matrix,a,s);for(var h in this.nodePrograms){var c=this.nodePrograms[h];c.bind(),c.bufferData(),c.render({matrix:this.matrix,width:this.width,height:this.height,ratio:a.ratio,correctionRatio:this.correctionRatio/a.ratio,scalingRatio:this.pixelRatio})}if(!this.settings.hideEdgesOnMove||!o)for(var h in this.edgePrograms){var c=this.edgePrograms[h];c.bind(),c.bufferData(),c.render({matrix:this.matrix,width:this.width,height:this.height,ratio:a.ratio,correctionRatio:this.correctionRatio/a.ratio,scalingRatio:this.pixelRatio})}return this.settings.hideLabelsOnMove&&o||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),r()},t.prototype.updateCachedValues=function(){var e=this.camera.getState().ratio;this.cameraSizeRatio=Math.sqrt(e)},t.prototype.getCamera=function(){return this.camera},t.prototype.getContainer=function(){return this.container},t.prototype.getGraph=function(){return this.graph},t.prototype.setGraph=function(e){e!==this.graph&&(this.unbindGraphHandlers(),this.nodeDataCache={},this.edgeDataCache={},this.displayedLabels.clear(),this.highlightedNodes.clear(),this.hoveredNode=null,this.hoveredEdge=null,this.nodesWithForcedLabels.length=0,this.edgesWithForcedLabels.length=0,this.checkEdgesEventsFrame!==null&&((0,G.cancelFrame)(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=e,this.bindGraphHandlers(),this.process(),this.render())},t.prototype.getMouseCaptor=function(){return this.mouseCaptor},t.prototype.getTouchCaptor=function(){return this.touchCaptor},t.prototype.getDimensions=function(){return{width:this.width,height:this.height}},t.prototype.getGraphDimensions=function(){var e=this.customBBox||this.nodeExtent;return{width:e.x[1]-e.x[0]||1,height:e.y[1]-e.y[0]||1}},t.prototype.getNodeDisplayData=function(e){var r=this.nodeDataCache[e];return r?Object.assign({},r):void 0},t.prototype.getEdgeDisplayData=function(e){var r=this.edgeDataCache[e];return r?Object.assign({},r):void 0},t.prototype.getSettings=function(){return T({},this.settings)},t.prototype.getSetting=function(e){return this.settings[e]},t.prototype.setSetting=function(e,r){return this.settings[e]=r,(0,He.validateSettings)(this.settings),this.handleSettingsUpdate(),this.needToProcess=!0,this._scheduleRefresh(),this},t.prototype.updateSetting=function(e,r){return this.settings[e]=r(this.settings[e]),(0,He.validateSettings)(this.settings),this.handleSettingsUpdate(),this.needToProcess=!0,this._scheduleRefresh(),this},t.prototype.resize=function(){var e=this.width,r=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=(0,G.getPixelRatio)(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(e===this.width&&r===this.height)return this;this.emit("resize");for(var n in this.elements){var o=this.elements[n];o.style.width=this.width+"px",o.style.height=this.height+"px"}for(var n in this.canvasContexts)this.elements[n].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[n].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[n].scale(this.pixelRatio,this.pixelRatio);for(var n in this.webGLContexts)this.elements[n].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[n].setAttribute("height",this.height*this.pixelRatio+"px"),this.webGLContexts[n].viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio);return this},t.prototype.clear=function(){return this.webGLContexts.nodes.clear(this.webGLContexts.nodes.COLOR_BUFFER_BIT),this.webGLContexts.edges.clear(this.webGLContexts.edges.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this},t.prototype.refresh=function(){return this.needToProcess=!0,this._refresh(),this},t.prototype.scheduleRefresh=function(){return this.needToProcess=!0,this._scheduleRefresh(),this},t.prototype.getViewportZoomedState=function(e,r){var n=this.camera.getState(),o=n.ratio,a=n.angle,s=n.x,d=n.y,u=r/o,h={x:this.width/2,y:this.height/2},c=this.viewportToFramedGraph(e),l=this.viewportToFramedGraph(h);return{angle:a,x:(c.x-l.x)*(1-u)+s,y:(c.y-l.y)*(1-u)+d,ratio:r}},t.prototype.viewRectangle=function(){var e=0*this.width/8,r=0*this.height/8,n=this.viewportToFramedGraph({x:0-e,y:0-r}),o=this.viewportToFramedGraph({x:this.width+e,y:0-r}),a=this.viewportToFramedGraph({x:0,y:this.height+r});return{x1:n.x,y1:n.y,x2:o.x,y2:o.y,height:o.y-a.y}},t.prototype.framedGraphToViewport=function(e,r){r===void 0&&(r={});var n=!!r.cameraState||!!r.viewportDimensions||!!r.graphDimensions,o=r.matrix?r.matrix:n?(0,G.matrixFromCamera)(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getSetting("stagePadding")||0):this.matrix,a=(0,qe.multiplyVec2)(o,e);return{x:(1+a.x)*this.width/2,y:(1-a.y)*this.height/2}},t.prototype.viewportToFramedGraph=function(e,r){r===void 0&&(r={});var n=!!r.cameraState||!!r.viewportDimensions||!r.graphDimensions,o=r.matrix?r.matrix:n?(0,G.matrixFromCamera)(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getSetting("stagePadding")||0,!0):this.invMatrix,a=(0,qe.multiplyVec2)(o,{x:e.x/this.width*2-1,y:1-e.y/this.height*2});return isNaN(a.x)&&(a.x=0),isNaN(a.y)&&(a.y=0),a},t.prototype.viewportToGraph=function(e,r){return r===void 0&&(r={}),this.normalizationFunction.inverse(this.viewportToFramedGraph(e,r))},t.prototype.graphToViewport=function(e,r){return r===void 0&&(r={}),this.framedGraphToViewport(this.normalizationFunction(e),r)},t.prototype.getBBox=function(){return(0,G.graphExtent)(this.graph)},t.prototype.getCustomBBox=function(){return this.customBBox},t.prototype.setCustomBBox=function(e){return this.customBBox=e,this._scheduleRefresh(),this},t.prototype.kill=function(){this.emit("kill"),this.removeAllListeners(),this.camera.removeListener("updated",this.activeListeners.camera),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.quadtree=new or.default,this.nodeDataCache={},this.edgeDataCache={},this.nodesWithForcedLabels=[],this.edgesWithForcedLabels=[],this.highlightedNodes.clear(),this.renderFrame&&((0,G.cancelFrame)(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&((0,G.cancelFrame)(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var e=this.container;e.firstChild;)e.removeChild(e.firstChild)},t.prototype.scaleSize=function(e){return e/this.cameraSizeRatio},t.prototype.getCanvases=function(){return T({},this.elements)},t}(Za.TypedEventEmitter);Et.default=Xa;var nt=E&&E.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ae,"__esModule",{value:!0});ae.Sigma=ae.MouseCaptor=ae.QuadTree=ae.Camera=void 0;var ci=nt(Et);ae.Sigma=ci.default;var Qa=nt(et);ae.Camera=Qa.default;var Ja=nt(re);ae.QuadTree=Ja.default;var es=nt(rt);ae.MouseCaptor=es.default;var ts=ae.default=ci.default,rs=function(t){return t!==null&&typeof t=="function"&&typeof t.prototype=="object"&&typeof t.prototype.addUndirectedEdgeWithKey=="function"&&typeof t.prototype.dropNode=="function"},ze={};ze.addEdge=function(t,e,r,n,o,a){return e?r==null?t.addUndirectedEdge(n,o,a):t.addUndirectedEdgeWithKey(r,n,o,a):r==null?t.addDirectedEdge(n,o,a):t.addDirectedEdgeWithKey(r,n,o,a)};ze.copyEdge=function(t,e,r,n,o,a){return a=Object.assign({},a),e?r==null?t.addUndirectedEdge(n,o,a):t.addUndirectedEdgeWithKey(r,n,o,a):r==null?t.addDirectedEdge(n,o,a):t.addDirectedEdgeWithKey(r,n,o,a)};ze.mergeEdge=function(t,e,r,n,o,a){return e?r==null?t.mergeUndirectedEdge(n,o,a):t.mergeUndirectedEdgeWithKey(r,n,o,a):r==null?t.mergeDirectedEdge(n,o,a):t.mergeDirectedEdgeWithKey(r,n,o,a)};ze.updateEdge=function(t,e,r,n,o,a){return e?r==null?t.updateUndirectedEdge(n,o,a):t.updateUndirectedEdgeWithKey(r,n,o,a):r==null?t.updateDirectedEdge(n,o,a):t.updateDirectedEdgeWithKey(r,n,o,a)};var is=At,ns=function(t){if(!is(t))throw new Error("graphology-operators/to-mixed: expecting a valid graphology instance.");return t.copy({type:"mixed"})},os=At,as=function(t){if(!os(t))throw new Error("graphology-operators/to-multi: expecting a valid graphology instance.");return t.copy({multi:!0})},Rt={};Rt.cast=function(i,t){switch(i){case"boolean":t=t==="true";break;case"integer":case"long":case"float":case"double":t=+t;break;case"liststring":t=t?t.split("|"):[];break}return t};var ss=/["'<>&\s]/g;Rt.sanitizeTagName=function(t){return t.replace(ss,"").trim()};var us=rs,ds=ze.mergeEdge,hs=ns,cs=as,ls=Rt,li=ls.cast;function fs(i){return i!==i}function gs(i){var t=i.getAttribute("a"),e=i.getAttribute("r"),r=i.getAttribute("g"),n=i.getAttribute("b");return t?"rgba("+e+","+r+","+n+","+t+")":"rgb("+e+","+r+","+n+")"}function Me(i,t){var e=i.getElementsByTagName("viz:"+t)[0];return e||(e=i.getElementsByTagNameNS("viz",t)[0]),e||(e=i.getElementsByTagName(t)[0]),e}function ps(i){for(var t={},e,r,n=0,o=i.length;n<o;n++)e=i[n],e.nodeName!=="#text"&&(r=e.textContent.trim(),r&&(t[e.tagName.toLowerCase()]=e.textContent));return t}function hr(i){for(var t={},e={},r,n,o,a=0,s=i.length;a<s;a++)r=i[a],o=r.getAttribute("id")||r.getAttribute("for"),t[o]={id:o,type:r.getAttribute("type")||"string",title:fs(+o)?o:r.getAttribute("title")||o},n=r.getElementsByTagName("default")[0],n&&(e[t[o].title]=li(t[o].type,n.textContent));return[t,e]}function cr(i,t,e){var r={},n=e.getAttribute("label"),o=e.getAttribute("weight");n&&(r.label=n),o&&(r.weight=+o);for(var a=e.getElementsByTagName("attvalue"),s,d,u=0,h=a.length;u<h;u++)s=a[u],d=s.getAttribute("id")||s.getAttribute("for"),r[i[d].title]=li(i[d].type,s.getAttribute("value"));var c;for(c in t)c in r||(r[c]=t[c]);var l=Me(e,"color");l&&(r.color=gs(l)),l=Me(e,"size"),l&&(r.size=+l.getAttribute("value"));var f,p,m;return l=Me(e,"position"),l&&(f=l.getAttribute("x"),p=l.getAttribute("y"),m=l.getAttribute("z"),f&&(r.x=+f),p&&(r.y=+p),m&&(r.z=+m)),l=Me(e,"shape"),l&&(r.shape=l.getAttribute("value")),l=Me(e,"thickness"),l&&(r.thickness=+l.getAttribute("value")),r}var ys=function(t,e){return function(n,o,a){a=a||{};var s=a.addMissingNodes===!0,d,u=o,h,c,l,f,p,m,x,y,v;if(!us(n))throw new Error("graphology-gexf/parser: invalid Graph constructor.");if(typeof o=="string"&&(u=new t().parseFromString(o,"application/xml")),!(u instanceof e))throw new Error("graphology-gexf/parser: source should either be a XML document or a string.");var C=u.getElementsByTagName("graph")[0],_=u.getElementsByTagName("meta")[0],g=_&&_.childNodes||[],b=u.getElementsByTagName("node"),R=u.getElementsByTagName("edge"),ee=u.getElementsByTagName("attributes"),j=[],Q=[];for(y=0,v=ee.length;y<v;y++)h=ee[y],h.getAttribute("class")==="node"?j=h.getElementsByTagName("attribute"):h.getAttribute("class")==="edge"&&(Q=h.getElementsByTagName("attribute"));var k=C.getAttribute("defaultedgetype")||"undirected";k==="mutual"&&(k="undirected"),c=hr(j);var ne=c[0],me=c[1];c=hr(Q);var le=c[0],fe=c[1],we=R[0]?R[0].getAttribute("type")||k:"mixed",O=new n({type:we}),ot=ps(g),Ne=_&&_.getAttribute("lastmodifieddate");for(O.replaceAttributes(ot),Ne&&O.setAttribute("lastModifiedDate",Ne),y=0,v=b.length;y<v;y++)h=b[y],O.addNode(h.getAttribute("id"),cr(ne,me,h));for(y=0,v=R.length;y<v;y++)if(h=R[y],p=h.getAttribute("id"),l=h.getAttribute("type")||k,m=h.getAttribute("source"),x=h.getAttribute("target"),f=cr(le,fe,h),l!==O.type&&O.type!=="mixed"&&(O=hs(O)),!O.multi&&(l==="directed"&&O.hasDirectedEdge(m,x)||O.hasUndirectedEdge(m,x))&&(O=cs(O)),d=ds(O,l!=="directed",p||null,m,x,f),!s&&(d[2]||d[3]))throw new Error("graphology-gexf/parser: one of your gexf file edges points to an inexisting node. Set the parser `addMissingNodes` option to `true` if you do not care.");return O}},ms=ys,vs=ms(DOMParser,Document),ws={exports:{}};function lr(i){return typeof i!="number"&&!i}function J(i){if(typeof i=="string")return i;if(typeof i=="number")return i+"";if(typeof i=="function")return i();if(i instanceof $e)return i.toString();throw Error("Bad Parameter")}function $e(i,t){if(!(this instanceof $e))return new $e;this.name_regex=/[_:A-Za-z][-._:A-Za-z0-9]*/,this.indent=!!i,this.indentString=this.indent&&typeof i=="string"?i:"    ",this.output="",this.stack=[],this.tags=0,this.attributes=0,this.attribute=0,this.texts=0,this.comment=0,this.dtd=0,this.root="",this.pi=0,this.cdata=0,this.started_write=!1,this.writer,this.writer_encoding="UTF-8",typeof t=="function"?this.writer=t:this.writer=function(e,r){this.output+=e}}$e.prototype={toString:function(){return this.flush(),this.output},indenter:function(){if(this.indent){this.write(`
`);for(var i=1;i<this.tags;i++)this.write(this.indentString)}},write:function(){for(var i=0;i<arguments.length;i++)this.writer(arguments[i],this.writer_encoding)},flush:function(){for(var i=this.tags;i>0;i--)this.endElement();this.tags=0},startDocument:function(i,t,e){return this.tags||this.attributes?this:(this.startPI("xml"),this.startAttribute("version"),this.text(typeof i=="string"?i:"1.0"),this.endAttribute(),typeof t=="string"&&(this.startAttribute("encoding"),this.text(t),this.endAttribute(),this.writer_encoding=t),e&&(this.startAttribute("standalone"),this.text("yes"),this.endAttribute()),this.endPI(),this.indent||this.write(`
`),this)},endDocument:function(){return this.attributes&&this.endAttributes(),this},writeElement:function(i,t){return this.startElement(i).text(t).endElement()},writeElementNS:function(i,t,e,r){return r||(r=e),this.startElementNS(i,t,e).text(r).endElement()},startElement:function(i){if(i=J(i),!i.match(this.name_regex)||this.tags===0&&this.root&&this.root!==i)throw Error("Invalid Parameter");return this.attributes&&this.endAttributes(),++this.tags,this.texts=0,this.stack.length>0&&(this.stack[this.stack.length-1].containsTag=!0),this.stack.push({name:i,tags:this.tags}),this.started_write&&this.indenter(),this.write("<",i),this.startAttributes(),this.started_write=!0,this},startElementNS:function(i,t,e){if(i=J(i),t=J(t),!i.match(this.name_regex)||!t.match(this.name_regex))throw Error("Invalid Parameter");return this.attributes&&this.endAttributes(),++this.tags,this.texts=0,this.stack.length>0&&(this.stack[this.stack.length-1].containsTag=!0),this.stack.push({name:i+":"+t,tags:this.tags}),this.started_write&&this.indenter(),this.write("<",i+":"+t),this.startAttributes(),this.started_write=!0,this},endElement:function(){if(!this.tags)return this;var i=this.stack.pop();return this.attributes>0?(this.attribute&&(this.texts&&this.endAttribute(),this.endAttribute()),this.write("/"),this.endAttributes()):(i.containsTag&&this.indenter(),this.write("</",i.name,">")),--this.tags,this.texts=0,this},writeAttribute:function(i,t){return typeof t=="function"&&(t=t()),lr(t)?this:this.startAttribute(i).text(t).endAttribute()},writeAttributeNS:function(i,t,e,r){return r||(r=e),typeof r=="function"&&(r=r()),lr(r)?this:this.startAttributeNS(i,t,e).text(r).endAttribute()},startAttributes:function(){return this.attributes=1,this},endAttributes:function(){return this.attributes?(this.attribute&&this.endAttribute(),this.attributes=0,this.attribute=0,this.texts=0,this.write(">"),this):this},startAttribute:function(i){if(i=J(i),!i.match(this.name_regex))throw Error("Invalid Parameter");return!this.attributes&&!this.pi?this:this.attribute?this:(this.attribute=1,this.write(" ",i,'="'),this)},startAttributeNS:function(i,t,e){if(i=J(i),t=J(t),!i.match(this.name_regex)||!t.match(this.name_regex))throw Error("Invalid Parameter");return!this.attributes&&!this.pi?this:this.attribute?this:(this.attribute=1,this.write(" ",i+":"+t,'="'),this)},endAttribute:function(){return this.attribute?(this.attribute=0,this.texts=0,this.write('"'),this):this},text:function(i){return i=J(i),!this.tags&&!this.comment&&!this.pi&&!this.cdata?this:this.attributes&&this.attribute?(++this.texts,this.write(i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")),this):(this.attributes&&!this.attribute&&this.endAttributes(),this.comment||this.cdata?this.write(i):this.write(i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),++this.texts,this.started_write=!0,this)},writeComment:function(i){return this.startComment().text(i).endComment()},startComment:function(){return this.comment?this:(this.attributes&&this.endAttributes(),this.indenter(),this.write("<!--"),this.comment=1,this.started_write=!0,this)},endComment:function(){return this.comment?(this.write("-->"),this.comment=0,this):this},writeDocType:function(i,t,e,r){return this.startDocType(i,t,e,r).endDocType()},startDocType:function(i,t,e,r){if(this.dtd||this.tags)return this;if(i=J(i),t=t&&J(t),e=e&&J(e),r=r&&J(r),!i.match(this.name_regex)||t&&!t.match(/^[\w\-][\w\s\-\/\+\:\.]*/)||e&&!e.match(/^[\w\.][\w\-\/\\\:\.]*/)||r&&!r.match(/[\w\s\<\>\+\.\!\#\-\?\*\,\(\)\|]*/))throw Error("Invalid Parameter");return t=t?' PUBLIC "'+t+'"':e?" SYSTEM":"",e=e?' "'+e+'"':"",r=r?" ["+r+"]":"",this.started_write&&this.indenter(),this.write("<!DOCTYPE ",i,t,e,r),this.root=i,this.dtd=1,this.started_write=!0,this},endDocType:function(){return this.dtd?(this.write(">"),this):this},writePI:function(i,t){return this.startPI(i).text(t).endPI()},startPI:function(i){if(i=J(i),!i.match(this.name_regex))throw Error("Invalid Parameter");return this.pi?this:(this.attributes&&this.endAttributes(),this.started_write&&this.indenter(),this.write("<?",i),this.pi=1,this.started_write=!0,this)},endPI:function(){return this.pi?(this.write("?>"),this.pi=0,this):this},writeCData:function(i){return this.startCData().text(i).endCData()},startCData:function(){return this.cdata?this:(this.attributes&&this.endAttributes(),this.indenter(),this.write("<![CDATA["),this.cdata=1,this.started_write=!0,this)},endCData:function(){return this.cdata?(this.write("]]>"),this.cdata=0,this):this},writeRaw:function(i){return i=J(i),!this.tags&&!this.comment&&!this.pi&&!this.cdata?this:this.attributes&&this.attribute?(++this.texts,this.write(i.replace("&","&amp;").replace('"',"&quot;")),this):(this.attributes&&!this.attribute&&this.endAttributes(),++this.texts,this.write(i),this.started_write=!0,this)}};var bs=$e;(function(i){i.exports=bs})(ws);var _s=new Set(["color","size","x","y","z","shape","thickness"]);function fi(i,t,e){var r={},n;for(n in e)n==="label"?r.label=e.label:i==="edge"&&n==="weight"?r.weight=e.weight:_s.has(n)?(r.viz=r.viz||{},r.viz[n]=e[n]):(r.attributes=r.attributes||{},r.attributes[n]=e[n]);return r}fi.bind(null,"node");fi.bind(null,"edge");var Es=vs;const As="data:application/octet-stream;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxnZXhmIHhtbG5zPSJodHRwOi8vd3d3LmdlcGhpLm9yZy9nZXhmIiB4bWxuczp2aXo9Imh0dHA6Ly93d3cuZ2VwaGkub3JnL2dleGYvdml6Ij4NCiAgICA8Z3JhcGggdHlwZT0ic3RhdGljIj4NCg0KICAgICAgICA8IS0tIGRlZmluZSBhdHRyaWJ1dGVzIG4gLS0+DQogICAgICAgIDxhdHRyaWJ1dGVzIGNsYXNzPSJub2RlIiB0eXBlPSJzdGF0aWMiPg0KICAgICAgICAgICAgPGF0dHJpYnV0ZSBpZD0iMCIgdGl0bGU9Im5vZGVkZWYiIHR5cGU9InN0cmluZyIvPg0KICAgICAgICAgICAgPGF0dHJpYnV0ZSBpZD0iMiIgdGl0bGU9Im9jY3VycmVuY2VzIiB0eXBlPSJpbnRlZ2VyIi8+DQogICAgICAgIDwvYXR0cmlidXRlcz4NCg0KICAgICAgICA8bm9kZXM+DQogICAgICAgICAgICA8bm9kZSBpZD0iMCI+DQogICAgICAgICAgICAgICAgPHZpejpwb3NpdGlvbiB4PSItNSIgeT0iMCIgej0iMC4wIi8+DQogICAgICAgICAgICAgICAgPHZpejpzaXplIHZhbHVlPSIzMCIvPg0KICAgICAgICAgICAgICAgIDxhdHR2YWx1ZXM+DQogICAgICAgICAgICAgICAgICAgIDxhdHR2YWx1ZSBpZD0iMCIgdmFsdWU9Im4wIiAvPg0KICAgICAgICAgICAgICAgICAgICA8YXR0dmFsdWUgaWQ9IjIiIHZhbHVlPSIxIi8+DQogICAgICAgICAgICAgICAgPC9hdHR2YWx1ZXM+DQogICAgICAgICAgICA8L25vZGU+DQogICAgICAgICAgICA8bm9kZSBpZD0iMSI+DQogICAgICAgICAgICAgICAgPHZpejpwb3NpdGlvbiB4PSIwIiB5PSIwIiB6PSIwLjAiLz4NCiAgICAgICAgICAgICAgICA8dml6OnNpemUgdmFsdWU9IjMwIi8+DQogICAgICAgICAgICAgICAgPGF0dHZhbHVlcz4NCiAgICAgICAgICAgICAgICAgICAgPGF0dHZhbHVlIGlkPSIwIiB2YWx1ZT0ibjEiIC8+DQogICAgICAgICAgICAgICAgICAgIDxhdHR2YWx1ZSBpZD0iMiIgdmFsdWU9IjE0MyIvPg0KICAgICAgICAgICAgICAgIDwvYXR0dmFsdWVzPg0KICAgICAgICAgICAgPC9ub2RlPg0KICAgICAgICAgICAgPG5vZGUgaWQ9IjIiPg0KICAgICAgICAgICAgICAgIDx2aXo6cG9zaXRpb24geD0iNSIgeT0iMCIgej0iMC4wIi8+DQogICAgICAgICAgICAgICAgPHZpejpzaXplIHZhbHVlPSIzMCIvPg0KICAgICAgICAgICAgICAgIDxhdHR2YWx1ZXM+DQogICAgICAgICAgICAgICAgICAgIDxhdHR2YWx1ZSBpZD0iMCIgdmFsdWU9Im4yIiAvPg0KICAgICAgICAgICAgICAgICAgICA8YXR0dmFsdWUgaWQ9IjIiIHZhbHVlPSIxIi8+DQogICAgICAgICAgICAgICAgPC9hdHR2YWx1ZXM+DQogICAgICAgICAgICA8L25vZGU+DQogICAgICAgIDwvbm9kZXM+DQogICAgICAgIDxlZGdlcz4NCiAgICAgICAgICAgIDxlZGdlIGlkPSIwIiBzb3VyY2U9IjEiIHRhcmdldD0iMCIvPg0KICAgICAgICAgICAgPGVkZ2UgaWQ9IjEiIHNvdXJjZT0iMSIgdGFyZ2V0PSIyIi8+DQogICAgICAgIDwvZWRnZXM+DQogICAgPC9ncmFwaD4NCjwvZ2V4Zj4NCg==";let M,I;async function xs(i){const t=await fetch(As).then(e=>e.text());return M=Es(P,t),I=new ts(M,i,{minCameraRatio:.1,maxCameraRatio:10}),{graph:M,sigma:I}}let Ze;const Cs=new Uint8Array(16);function Ls(){if(!Ze&&(Ze=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ze))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ze(Cs)}const U=[];for(let i=0;i<256;++i)U.push((i+256).toString(16).slice(1));function Ss(i,t=0){return(U[i[t+0]]+U[i[t+1]]+U[i[t+2]]+U[i[t+3]]+"-"+U[i[t+4]]+U[i[t+5]]+"-"+U[i[t+6]]+U[i[t+7]]+"-"+U[i[t+8]]+U[i[t+9]]+"-"+U[i[t+10]]+U[i[t+11]]+U[i[t+12]]+U[i[t+13]]+U[i[t+14]]+U[i[t+15]]).toLowerCase()}const Ds=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fr={randomUUID:Ds};function Is(i,t,e){if(fr.randomUUID&&!t&&!i)return fr.randomUUID();i=i||{};const r=i.random||(i.rng||Ls)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){e=e||0;for(let n=0;n<16;++n)t[e+n]=r[n];return t}return Ss(r)}function Ts(i,t){if(L.mode!=="edition")return;const e={...I.viewportToGraph({x:i,y:t}),size:30},r=Is();M.addNode(r,e),$t(r)}function Ot(){L.mode==="edition"&&(L.selection=null)}function $t(i){L.mode==="edition"&&(Ot(),L.selection={type:"node",key:i})}function Ns(i){L.mode==="edition"&&(Ot(),L.selection={key:i,type:"edge"})}function Ps(i){L.mode==="edition"&&L.selection!=null&&L.selection.type==="node"&&i!==L.selection.key&&M.addEdge(L.selection.key,i)}function Fs(){L.mode==="edition"&&L.selection!==null&&(L.selection.type==="node"&&M.dropNode(L.selection.key),L.selection.type==="edge"&&M.dropEdge(L.selection.key),L.selection=null)}function Gs(i){L.mode==="edition"&&(L.drag.isDragging=!0,L.drag.draggedNode=i,$t(i))}function Ms(i,t){if(L.mode!=="edition"||!L.drag.isDragging||!L.drag.draggedNode)return;const{x:e,y:r}=I.viewportToGraph({x:i,y:t});M.setNodeAttribute(L.drag.draggedNode,"x",e),M.setNodeAttribute(L.drag.draggedNode,"y",r)}function Rs(){L.mode==="edition"&&(L.drag.isDragging=!1,L.drag.draggedNode=null)}function Os(){if(L.mode!=="edition")return;L.drag={isDragging:!1,draggedNode:null},L.selection=null,L.edgeCreation={tempNode:null};const i=u=>{u.preventSigmaDefault();const{event:h}=u;Ts(h.x,h.y)},t=u=>{u.preventSigmaDefault(),$t(u.node)},e=u=>{u.preventSigmaDefault(),Ns(u.edge)},r=u=>{u.preventSigmaDefault(),Ot()},n=u=>{u.preventSigmaDefault(),u.event.original.preventDefault(),Ps(u.node)},o=u=>{u.preventSigmaDefault(),u.event.original.button===0&&Gs(u.node)},a=u=>{L.mode==="edition"&&L.drag.isDragging&&(u.preventSigmaDefault(),Ms(u.x,u.y))},s=u=>{u.preventSigmaDefault(),Rs()},d=u=>{u.key==="Delete"&&(u.preventDefault(),Fs())};return I.on("doubleClickStage",i),I.on("clickNode",t),I.on("clickEdge",e),I.on("clickStage",r),I.on("rightClickNode",n),I.on("downNode",o),I.getMouseCaptor().on("mousemove",a),I.getMouseCaptor().on("mouseup",s),window.addEventListener("keydown",d),I.setSetting("nodeReducer",(u,h)=>{var l;if(L.mode!=="edition")return h;const c={...h};return u===((l=L.selection)==null?void 0:l.key)&&(c.color="dodgerblue"),c}),()=>{I.off("doubleClickStage",i),I.off("clickNode",t),I.off("clickEdge",e),I.off("clickStage",r),I.off("rightClickNode",n),I.off("downNode",o),I.getMouseCaptor().off("mousemove",a),I.getMouseCaptor().off("mouseup",s),window.removeEventListener("keydown",d),I.setSetting("nodeReducer",(u,h)=>h)}}function Ke(){if(L.mode!=="simulation")return;const i=document.querySelector("#day");i.textContent=`Jour ${L.history.length}`}function $s(){M.nodes().forEach(i=>{M.setNodeAttribute(i,"possibleFox",!0)})}function yt(){if(L.mode==="simulation"){if(L.history.length===0)return $s();L.history.at(-1).forEach((i,t)=>{M.setNodeAttribute(t,"possibleFox",i)})}}function ks(i){if(L.mode!=="simulation")return;const t=new Map;L.history.push(t),Ke(),M.nodes().forEach(e=>{const r=M.neighbors(e).some(n=>n===i.node?!1:M.getNodeAttribute(n,"possibleFox"));t.set(e,r)}),yt()}function Us(){if(L.mode!=="simulation")return;const i=o=>ks(o);I.on("clickNode",i),M.nodes().forEach(o=>{M.setNodeAttribute(o,"possibleFox",!0)}),I.setSetting("nodeReducer",(o,a)=>{const s={...a};return s.color="orange",M.getNodeAttribute(o,"possibleFox")===!1&&(s.color="red"),s}),L.history=[],Ke();const t=document.querySelector("#back-button"),e=()=>{L.mode==="simulation"&&(L.history.pop(),yt(),Ke())};t.addEventListener("click",e);const r=document.querySelector("#reset-button"),n=()=>{L.mode==="simulation"&&(L.history.splice(0),yt(),Ke())};return r.addEventListener("click",n),()=>{I.off("clickNode",i),M.nodes().forEach(o=>{M.removeNodeAttribute(o,"possibleFox")}),I.setSetting("nodeReducer",(o,a)=>a),t.removeEventListener("click",e),r.removeEventListener("click",n)}}const zs=document.querySelector("#mode-name");let ct;const gr=i=>{ct&&ct(),L.mode=i;const t={simulation:{name:"Simulation",initFn:Us},edition:{name:"Modification",initFn:Os}};zs.textContent=t[i].name,document.body.className=i,ct=t[i].initFn()};let L={mode:"simulation",changeMode:gr,toggleMode:()=>{gr(L.mode==="simulation"?"edition":"simulation")}};const js=document.querySelector("#zoom-in-btn"),Bs=document.querySelector("#zoom-out-btn"),Ws=document.querySelector("#reset-zoom-btn");js.addEventListener("click",Hs);Bs.addEventListener("click",qs);Ws.addEventListener("click",Zs);function Hs(){I.getCamera().animatedZoom({duration:250})}function qs(){I.getCamera().animatedUnzoom({duration:250})}function Zs(){I.setCustomBBox(I.getBBox()),I.refresh(),I.getCamera().animatedReset({duration:500})}const Ys=document.querySelector("#sigma-container");xs(Ys).then(({sigma:i})=>{i.setCustomBBox(i.getBBox()),document.querySelector("#mode-change").addEventListener("click",()=>L.toggleMode()),L.changeMode("simulation")});
